Getting files for app H2LnOaVy-ncwpzaor in org H2LnOaVy / space DTC_challenge as CRAFTuser@H2LnOaVy...
OK

[{"type":"tab","id":"7f85b702.453d98","label":"Sheet 1"},{"type":"tab","id":"1db0a15.c98455f","label":"Other Sample"},{"type":"tab","id":"cdc0c767.e028d8","label":"K5 Iot Sample1"},{"type":"tab","id":"a8412bb4.2f2328","label":"Postgres API"},{"type":"tab","id":"22b4aa07.a66d76","label":"Sensor Manage Sample"},{"id":"5fbac071.4b08d","type":"websocket-listener","path":"/ws/sensor1","wholemsg":"false"},{"id":"11917135.5de19f","type":"mqtt-broker","broker":"api.trial2.iot.jp.fujitsu.com","port":"1883","clientid":""},{"id":"a7949bb6.944e38","type":"websocket-listener","path":"/ws/sensor2","wholemsg":"false"},{"id":"8fdc7071.ca817","type":"websocket-listener","path":"/ws/sensor","wholemsg":"false"},{"id":"437ce790.863708","type":"websocket-listener","path":"/ws/sensor3","wholemsg":"false"},{"id":"f45a52fa.a21f","type":"websocket-listener","path":"/ws/sensor4","wholemsg":"false"},{"id":"435211f1.bcadf","type":"websocket-listener","path":"/ws/rtchart","wholemsg":"false"},{"id":"a7aa3c6e.2da45","type":"ui_tab","name":"Temperature Status","icon":"dashboard","order":"1"},{"id":"85520cfd.6c5a3","type":"ui_tab","name":"Temperature Chart Graph 1 Hour","icon":"dashboard","order":"1"},{"id":"aecdcf58.fb5c9","type":"ui_tab","name":"Humidity Status","icon":"dashboard","order":"1"},{"id":"9614aa63.ea9888","type":"ui_tab","name":"Humidity Chart Graph 1 Hour","icon":"dashboard","order":"1"},{"id":"a26c4963.778498","type":"ui_tab","name":"Humidity Chart Graph 12 Hours","icon":"dashboard","order":"1"},{"id":"b2251b3a.e88bc8","type":"ui_tab","name":"Humidity Chart Graph 1 Week","icon":"dashboard","order":"1"},{"id":"a09df126.e15a5","type":"ui_tab","name":"Temperature Chart Graph 12 Hours","icon":"dashboard","order":"1"},{"id":"3d5dc16c.f5300e","type":"ui_tab","name":"Temperature Chart Graph 1 Week","icon":"dashboard","order":"1"},{"id":"1cdc5509.3fb37b","type":"sqldbsdatabase","host":"ArFMyqjbImh-uJQyrqLgDc4CMHlxlGR-pT5l-284NIxXNiiOx-4290000.database-jp-east-1.internal.cloud.global.fujitsu.com","port":"26500","db":"clqa9mwl","dialect":"postgres"},{"id":"54192100.1d709","type":"websocket-listener","path":"/ws/sensor5","wholemsg":"false"},{"id":"5945612.f2a34a","type":"websocket-listener","path":"/ws/sensor6","wholemsg":"false"},{"id":"13fa2ec7.0e6081","type":"websocket-listener","path":"/ws/sensor7","wholemsg":"false"},{"id":"7bf18ae5.ceac64","type":"websocket-listener","path":"/ws/sensor8","wholemsg":"false"},{"id":"b88098e5.2edd18","type":"postgresdb","hostname":"ArFMyqjbImh-uJQyrqLgDc4CMHlxlGR-pT5l-284NIxXNiiOx-4290000.database-jp-east-1.internal.cloud.global.fujitsu.com","port":"26500","db":"clqa9mwl","ssl":false},{"id":"168f2030.e970e","type":"postgresdb","hostname":"localhost","port":"5432","db":"postgres"},{"id":"735aba0d.4d1c04","type":"mqtt-broker","broker":"test.mosquitto.org","port":"1883","clientid":""},{"id":"9094c195.9448d","type":"inject","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":117,"y":85,"z":"7f85b702.453d98","wires":[["1b818e55.dc4082"]]},{"id":"1b818e55.dc4082","type":"debug","name":"","active":false,"console":"false","complete":"false","x":525,"y":81,"z":"7f85b702.453d98","wires":[]},{"id":"875adff8.48f8e","type":"http in","name":"","url":"/Tabulator","method":"get","x":208,"y":122,"z":"1db0a15.c98455f","wires":[["c411ef65.9f581"]]},{"id":"c411ef65.9f581","type":"template","name":"Script","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link href=\"https://cdnjs.cloudflare.com/ajax/libs/tabulator/2.11.0/tabulator.min.css\" rel=\"stylesheet\">\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://d3js.org/d3.v4.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/tabulator/2.11.0/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery.fancytree/2.23.0/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment-with-locales.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.13/moment-timezone-with-data.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n\n<!--\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/jquery.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/d3.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/jquery-ui.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/jquery.radios-to-slider.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/tabulator.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/jquery.fancytree-all.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/tauCharts.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/underscore-min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/moment-with-locales.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/moment-timezone-with-data.js\"></script>\n\t<link href=\"http://localhost:81/stylesheets/themes/semantic-ui/tabulator_semantic-ui.css\" rel=\"stylesheet\">\n\t<script type=\"text/javascript\" src=\"https://cdnjs.cloudflare.com/ajax/libs/tauCharts/1.2.1/tauCharts.min.js\"></script>\n\t<link href=\"https://cdnjs.cloudflare.com/ajax/libs/tauCharts/1.2.1/tauCharts.min.css\" rel=\"stylesheet\">\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"http://localhost:81/javascripts/date-time-week.js\"></script>\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"http://localhost:81/stylesheets/style.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"http://localhost:81/stylesheets/style_20170523.css\">\n-->\n\n</head>\n\n<p><span style = 'color:blue; font-size:140%; font-weight:bold;'>-----< Tabulator を使用して表を作成 >-----</span></p>\n<br>\n\n<p><span style = 'color:red; font-size:120%; font-weight:bold;'>環境センサー稼働状況一覧</span></p>\n<input type=\"button\" value=\"更新\" onclick=\"location.reload();\" /> \n\n<br>\n<div id=\"example-table\"></div>\n<br/>\n\n<p><span style = 'color:red; font-size:120%; font-weight:bold;'>ラック扉開閉状況一覧</span></p>\n<input type=\"button\" value=\"更新\" onclick=\"location.reload();\" /> \n\n<br>\n<div id=\"door-table\"></div>\n<br/>\n\n<script>\n\nkoshin();\ndatetimeweek();\n\n//trigger download of data.csv file\n$(\"#download-csv\").click(function(){\n\t$(\"#example-table\").tabulator(\"download\", \"csv\", \"data.csv\");\n});\n\n//trigger download of data.json file\n$(\"#download-json\").click(function(){\n\t$(\"#example-table\").tabulator(\"download\", \"json\", \"data.json\");\n});\n\n$(\"#example-table\").tabulator({\n\theight:\"640px\",\n\tdateFormat:\"yyyy/mm/dd\",\n\tfitColumns:true,\n//\tpagination:true,\n//\ttooltips:true,\n\tmovableRows:true,\n\tcolumns:[\n\t\t{title:\"Sensor Name\", field:\"name\", sortable:true, width:200, align:\"center\"},\n\t\t{title:\"Status\", field:\"doacheck\", sorter:\"boolean\", sortable:true, align:\"center\", formatter:\"tickCross\", width:100},\n\t\t{title:\"Place\", field:\"place\", sortable:true, sorter:\"number\", width:200, align:\"center\"},\n\t\t{title:\"Date\", field:\"date\", sortable:true, sorter:\"date\", width:150, align:\"center\"},\n\t\t{title:\"Time\", field:\"time\", sortable:false, width:150, align:\"center\"},\n\t\t{title:\"Ambient Temperature\", field:\"temp\", sortable:true, sorter:\"number\", align:\"center\", width:100},\n\t\t{title:\"Object Temperature\", field:\"objectTemp\", sortable:true, sorter:\"number\", align:\"center\", width:100},\n\t\t{title:\"Humidity\", field:\"humidity\", sortable:true, sorter:\"number\", align:\"center\", width:100},\n\t\t{title:\"Barometer\", field:\"barometer\", sortable:true, sorter:\"number\", align:\"center\", width:100},\n\t\t{title:\"lux\", field:\"lux\", sortable:true, sorter:\"number\", align:\"center\", width:100},\n\t\t{title:\"Note\", field:\"note\", sortable:false, width:300, align:\"left\", editable:true},\n\t],\n});\n\n$(\"#example-table\").tabulator(\"setData\", \"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/data/data15.json\");\n\n\n$(\"#door-table\").tabulator({\n\theight:\"320px\",\n\tdateFormat:\"yyyy/mm/dd\",\n\tfitColumns:true,\n//\tpagination:true,\n//\ttooltips:true,\n\tmovableRows:true,\n\tcolumns:[\n\t\t{title:\"Rack Name\", field:\"place\", sortable:true, sorter:\"number\", width:200, align:\"center\"},\n\t\t{title:\"Door Status\", field:\"door_open\", sorter:\"boolean\", sortable:true, align:\"center\", formatter:\"tickCross\", width:150},\n\t\t{title:\"Date\", field:\"date\", sortable:true, sorter:\"date\", width:150, align:\"center\"},\n\t\t{title:\"Time\", field:\"time\", sortable:false, width:150, align:\"center\"},\n\t\t{title:\"Note\", field:\"note\", sortable:false, width:300, align:\"left\", editable:true},\n\t],\n});\n\n$(\"#door-table\").tabulator(\"setData\", \"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/data/data16.json\");\n\n\n\n\n</script>\n\n</body>\n</html>","x":400,"y":122,"z":"1db0a15.c98455f","wires":[["9ecfca3c.ea6a28"]]},{"id":"9ecfca3c.ea6a28","type":"http response","name":"","x":631,"y":122,"z":"1db0a15.c98455f","wires":[]},{"id":"64bd18f4.f56218","type":"inject","name":"","topic":"","payload":"","payloadType":"none","repeat":"60","crontab":"","once":false,"x":105,"y":142,"z":"cdc0c767.e028d8","wires":[["27dbc0b9.45048","c9d2550.722a1a8","4a9a013a.64e2f","cfcbc137.b93de","8391002e.a62b6","49148932.266d28","f44908a7.a470e8","67f70e84.63db5"]]},{"id":"27dbc0b9.45048","type":"function","name":"Create dummy rundom data for Sensor1","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor1\";\n\n// Object of place\nvar location1 = \"ServerRack1\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":384,"y":143,"z":"cdc0c767.e028d8","wires":[["8285b173.629b9"]]},{"id":"c9d2550.722a1a8","type":"function","name":"Create dummy rundom data for Sensor2","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor2\";\n\n// Object of place\nvar location1 = \"ServerRack2\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":384,"y":179,"z":"cdc0c767.e028d8","wires":[["bbe90f18.f4bf4"]]},{"id":"4a9a013a.64e2f","type":"function","name":"Create dummy rundom data for Sensor3","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor3\";\n\n// Object of place\nvar location1 = \"ServerRack3\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":384.75,"y":215,"z":"cdc0c767.e028d8","wires":[["6fa7bead.284fb"]]},{"id":"cfcbc137.b93de","type":"function","name":"Create dummy rundom data for Sensor4","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor4\";\n\n// Object of place\nvar location1 = \"ServerRack4\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":385.75,"y":251,"z":"cdc0c767.e028d8","wires":[["a07d9875.508138"]]},{"id":"e5a04145.c9f15","type":"template","name":"Authrization Header","field":"headers.Authorization","template":"Bearer testcode2","x":763.75,"y":440,"z":"cdc0c767.e028d8","wires":[["49310a1f.0b0fa4"]]},{"id":"49310a1f.0b0fa4","type":"http request","name":"REST API Put data","method":"PUT","ret":"txt","url":"http://api.trial2.iot.jp.fujitsu.com/v1/ITP314-001/DTC/TEST2","x":979.75,"y":440,"z":"cdc0c767.e028d8","wires":[["4a9c7651.5514c8"]]},{"id":"4a9c7651.5514c8","type":"debug","name":"","active":false,"console":"false","complete":"false","x":1183.75,"y":441,"z":"cdc0c767.e028d8","wires":[]},{"id":"fb947c2f.50424","type":"comment","name":"Send data to MQTT Out(Publish)","info":"","x":800,"y":105,"z":"cdc0c767.e028d8","wires":[]},{"id":"83784a9e.4c9ab8","type":"comment","name":"Send data to REST API Put","info":"","x":782.75,"y":404,"z":"cdc0c767.e028d8","wires":[]},{"id":"260c6ebe.47cd22","type":"debug","name":"","active":false,"console":"false","complete":"false","x":513.75,"y":479,"z":"cdc0c767.e028d8","wires":[]},{"id":"57228b5e.305f74","type":"json","name":"","x":295.75,"y":558,"z":"cdc0c767.e028d8","wires":[["260c6ebe.47cd22","ed6a0e8f.5552","9a5a9e78.7a1fa","46185412.d02fdc"]]},{"id":"bbfd0cd0.6d6ab","type":"comment","name":"Subscribe from MQTT In","info":"","x":138.75,"y":449,"z":"cdc0c767.e028d8","wires":[]},{"id":"9a5a9e78.7a1fa","type":"csv","name":"JSON to CSV output","sep":",","hdrin":"","hdrout":false,"multi":"one","ret":"\\n","temp":"date,time,sensorname,temperature,humidity","x":535.75,"y":520,"z":"cdc0c767.e028d8","wires":[["b30aadec.9ed8d","d9f01181.bcb4c"]]},{"id":"b30aadec.9ed8d","type":"debug","name":"","active":false,"console":"false","complete":"false","x":752.75,"y":541,"z":"cdc0c767.e028d8","wires":[]},{"id":"d9f01181.bcb4c","type":"file","name":"Write to CSV File","filename":"public/data/test_20170707.csv","appendNewline":false,"overwriteFile":"false","x":766.75,"y":500,"z":"cdc0c767.e028d8","wires":[]},{"id":"ed6a0e8f.5552","type":"switch","name":"Separate by SensorName","property":"payload.sensorname","rules":[{"t":"eq","v":"Sensor1"},{"t":"eq","v":"Sensor2"},{"t":"eq","v":"Sensor3"},{"t":"eq","v":"Sensor4"},{"t":"eq","v":"Sensor5"},{"t":"eq","v":"Sensor6"},{"t":"eq","v":"Sensor7"},{"t":"eq","v":"Sensor8"}],"checkall":"true","outputs":8,"x":174.75,"y":779.9999942779541,"z":"cdc0c767.e028d8","wires":[["a274c7f8.80b608","6dd96315.366a1c","c2903fc4.2337c"],["2cc0b0f0.91a66","212fb869.f85528","c82a8176.f40f1"],["d1f96d30.f2cfd","4f98d6b0.1d7038","77f8001.98c4"],["fd7de7cc.bdb838","b4419131.8a28b","cd4abf1e.15a2e"],["113065e5.5ea87a","79fa325.30cddcc","454bbdb4.4d7914"],["c41412af.1bfaa","cb977d9e.a866e","2525030b.6766fc"],["48c5ecb0.231d04","7496c95b.d83848","707604a1.90909c"],["a83c2da9.da1f2","a58c8bff.0551d8","a4575b4f.4e4f58"]]},{"id":"6dd96315.366a1c","type":"function","name":"Sensor1 Temp Payload","func":"return {payload:msg.payload.temperature};","outputs":1,"x":651.4444580078125,"y":705.1666202545166,"z":"cdc0c767.e028d8","wires":[["28d7a0e6.6d372","4a2849a2.ebbfe8","5c144d36.679e14","b2602b9.3cae3d8"]]},{"id":"212fb869.f85528","type":"function","name":"Sensor2 Temp Payload","func":"return {payload:msg.payload.temperature};\n","outputs":1,"x":649.9167060852051,"y":744.9167232513428,"z":"cdc0c767.e028d8","wires":[["126c2740.00f619","a794b498.36eb08","f8cad88c.f91b28","ef1e423d.f6efe"]]},{"id":"4f98d6b0.1d7038","type":"function","name":"Sensor3 Temp Payload","func":"return {payload:msg.payload.temperature};","outputs":1,"x":651.6111450195312,"y":785.3333683013916,"z":"cdc0c767.e028d8","wires":[["af28593a.d48d08","71e2f59a.5f232c","9c0aa407.137d28","d5d3f48d.c43978"]]},{"id":"b4419131.8a28b","type":"function","name":"Sensor4 Temp Payload","func":"return {payload:msg.payload.temperature};","outputs":1,"x":651.3055419921875,"y":826.8055973052979,"z":"cdc0c767.e028d8","wires":[["d21c0a38.552ab8","b18eb1ef.13738","a6d745f.7f784b8","516299c2.6adea8"]]},{"id":"45dbbb16.c0cfb4","type":"comment","name":"Make dummy data to Publish","info":"","x":345,"y":105,"z":"cdc0c767.e028d8","wires":[]},{"id":"eea58650.f53cf8","type":"websocket out","name":"/ws/sensor1","server":"5fbac071.4b08d","client":"","x":295.75,"y":1018.6667423248291,"z":"cdc0c767.e028d8","wires":[]},{"id":"a274c7f8.80b608","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":128.1944580078125,"y":1017.6666355133057,"z":"cdc0c767.e028d8","wires":[["eea58650.f53cf8"]]},{"id":"2cc0b0f0.91a66","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":128.08334350585938,"y":1058.1111297607422,"z":"cdc0c767.e028d8","wires":[["adf45304.a3095"]]},{"id":"d1f96d30.f2cfd","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":130.08334350585938,"y":1100.1111297607422,"z":"cdc0c767.e028d8","wires":[["ff1f7cc2.e65fa"]]},{"id":"fd7de7cc.bdb838","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":130.97222900390625,"y":1139.888910293579,"z":"cdc0c767.e028d8","wires":[["3da09391.aa570c"]]},{"id":"adf45304.a3095","type":"websocket out","name":"/ws/sensor2","server":"a7949bb6.944e38","client":"","x":295.8611297607422,"y":1059.000036239624,"z":"cdc0c767.e028d8","wires":[]},{"id":"9ab33fcf.c59e5","type":"comment","name":"HTTP URL","info":"","x":116.75000762939453,"y":1489.5000047683716,"z":"cdc0c767.e028d8","wires":[]},{"id":"fab425cd.4b6748","type":"http in","name":"","url":"/sensor","method":"get","x":121.75000762939453,"y":1528.7500257492065,"z":"cdc0c767.e028d8","wires":[["973bc972.f82078"]]},{"id":"973bc972.f82078","type":"template","name":"All Sensor Visualize","field":"payload","template":"<!DOCTYPE html>\n<html>\n<head>\n\t<meta charset=\"UTF-8\">\n\t<title>Sensor Data Visualization</title>\n\t<link href=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\" rel=\"stylesheet\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<script src=\"https://code.jquery.com/jquery-3.2.1.slim.min.js\" integrity=\"sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"//www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script>\n\t<script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://oss.maxcdn.com/respond/1.4.2/respond.min.js\"></script>\n\t<script type=\"text/javascript\">\n\n// Sensor1 JS Section\n\nvar wsUrl1 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor1';\n\tvar socket;\n\t\tvar temperatureData1, humidityData1;\n\t\tvar temperatureOptions1, humidityOptions1;\n\t\tvar temperatureChart1, humidityChart1;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart1);\n\t\tfunction drawChart1() {\n\n\t// Data for Sensor1 temperature chart\n\t\ttemperatureData1 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Seosor1', 0],\n\t\t]);\n\n\t// Data for Sensor1 humidity chart\n\t\thumidityData1 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor1', 0]\n\t\t]);\n\n\t// Option for Sensor1 temperature chart\n\t\ttemperatureOptions1 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor1 humidity chart\n\t\thumidityOptions1 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\ttemperatureChart1 = new google.visualization.Gauge(document.getElementById('temperatureChart1'));\n\thumidityChart1 = new google.visualization.Gauge(document.getElementById('humidityChart1'));\n\n\ttemperatureChart1.draw(temperatureData1, temperatureOptions1);\n\thumidityChart1.draw(humidityData1, humidityOptions1);\n\n\t};\n\n// Sensor2 JS Section\n\nvar wsUrl2 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor2';\n\tvar socket;\n\t\tvar temperatureData2, humidityData2;\n\t\tvar temperatureOptions2, humidityOptions2;\n\t\tvar temperatureChart2, humidityChart2;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart2);\n\t\tfunction drawChart2() {\n\n\t// Data for Sensor2 temperature chart\n\ttemperatureData2 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor2', 0],\n\t\t]);\n\n\t// Data for Sensor2 humidity chart\n\thumidityData2 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor2', 0]\n\t\t]);\n\n\t// Option for Sensor2 temperature chart\n\ttemperatureOptions2 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor2 humidity chart\n\thumidityOptions2 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart2 = new google.visualization.Gauge(document.getElementById('temperatureChart2'));\n\thumidityChart2 = new google.visualization.Gauge(document.getElementById('humidityChart2'));\n\n\ttemperatureChart2.draw(temperatureData2, temperatureOptions2);\n\thumidityChart2.draw(humidityData2, humidityOptions2);\n\n\t};\n\n// Sensor3 JS Section\n\nvar wsUrl3 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor3';\n\tvar socket;\n\t\tvar temperatureData3, humidityData3;\n\t\tvar temperatureOptions3, humidityOptions3;\n\t\tvar temperatureChart3, humidityChart3;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart3);\n\t\tfunction drawChart3() {\n\n\t// Data for Sensor3 temperature chart\n\ttemperatureData3 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor3', 0],\n\t\t]);\n\n\t// Data for Sensor3 humidity chart\n\thumidityData3 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor3', 0]\n\t\t]);\n\n\t// Option for Sensor3 temperature chart\n\ttemperatureOptions3 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor3 humidity chart\n\thumidityOptions3 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart3 = new google.visualization.Gauge(document.getElementById('temperatureChart3'));\n\thumidityChart3 = new google.visualization.Gauge(document.getElementById('humidityChart3'));\n\n\ttemperatureChart3.draw(temperatureData3, temperatureOptions3);\n\thumidityChart3.draw(humidityData3, humidityOptions3);\n\n\t};\n\n// Sensor4 JS Section\n\nvar wsUrl4 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor4';\n\tvar socket;\n\t\tvar temperatureData4, humidityData4;\n\t\tvar temperatureOptions4, humidityOptions4;\n\t\tvar temperatureChart4, humidityChart4;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart4);\n\t\tfunction drawChart4() {\n\n\t// Data for Sensor4 temperature chart\n\ttemperatureData4 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor4', 0],\n\t\t]);\n\n\t// Data for Sensor4 humidity chart\n\thumidityData4 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor4', 0]\n\t\t]);\n\n\t// Option for Sensor4 temperature chart\n\ttemperatureOptions4 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor4 humidity chart\n\thumidityOptions4 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart4 = new google.visualization.Gauge(document.getElementById('temperatureChart4'));\n\thumidityChart4 = new google.visualization.Gauge(document.getElementById('humidityChart4'));\n\n\ttemperatureChart4.draw(temperatureData4, temperatureOptions4);\n\thumidityChart4.draw(humidityData4, humidityOptions4);\n\n\t};\n\n// Sensor5 JS Section\n\nvar wsUrl5 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor5';\n\tvar socket;\n\t\tvar temperatureData5, humidityData5;\n\t\tvar temperatureOptions5, humidityOptions5;\n\t\tvar temperatureChart5, humidityChart5;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart5);\n\t\tfunction drawChart5() {\n\n\t// Data for Sensor5 temperature chart\n\ttemperatureData5 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor5', 0],\n\t\t]);\n\n\t// Data for Sensor5 humidity chart\n\thumidityData5 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor5', 0]\n\t\t]);\n\n\t// Option for Sensor5 temperature chart\n\ttemperatureOptions5 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor5 humidity chart\n\thumidityOptions5 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart5 = new google.visualization.Gauge(document.getElementById('temperatureChart5'));\n\thumidityChart5 = new google.visualization.Gauge(document.getElementById('humidityChart5'));\n\n\ttemperatureChart5.draw(temperatureData5, temperatureOptions5);\n\thumidityChart5.draw(humidityData5, humidityOptions5);\n\n\t};\n\n// Sensor6 JS Section\n\nvar wsUrl6 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor6';\n\tvar socket;\n\t\tvar temperatureData6, humidityData6;\n\t\tvar temperatureOptions6, humidityOptions6;\n\t\tvar temperatureChart6, humidityChart6;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart6);\n\t\tfunction drawChart6() {\n\n\t// Data for Sensor6 temperature chart\n\ttemperatureData6 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor6', 0],\n\t\t]);\n\n\t// Data for Sensor6 humidity chart\n\thumidityData6 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor6', 0]\n\t\t]);\n\n\t// Option for Sensor6 temperature chart\n\ttemperatureOptions6 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor6 humidity chart\n\thumidityOptions6 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart6 = new google.visualization.Gauge(document.getElementById('temperatureChart6'));\n\thumidityChart6 = new google.visualization.Gauge(document.getElementById('humidityChart6'));\n\n\ttemperatureChart6.draw(temperatureData6, temperatureOptions6);\n\thumidityChart6.draw(humidityData6, humidityOptions6);\n\n\t};\n\n// Sensor7 JS Section\n\nvar wsUrl7 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor7';\n\tvar socket;\n\t\tvar temperatureData7, humidityData7;\n\t\tvar temperatureOptions7, humidityOptions7;\n\t\tvar temperatureChart7, humidityChart7;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart7);\n\t\tfunction drawChart7() {\n\n\t// Data for Sensor7 temperature chart\n\ttemperatureData7 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor7', 0],\n\t\t]);\n\n\t// Data for Sensor7 humidity chart\n\thumidityData7 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor7', 0]\n\t\t]);\n\n\t// Option for Sensor7 temperature chart\n\ttemperatureOptions7 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor7 humidity chart\n\thumidityOptions7 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart7 = new google.visualization.Gauge(document.getElementById('temperatureChart7'));\n\thumidityChart7 = new google.visualization.Gauge(document.getElementById('humidityChart7'));\n\n\ttemperatureChart7.draw(temperatureData7, temperatureOptions7);\n\thumidityChart7.draw(humidityData7, humidityOptions7);\n\n\t};\n\n// Sensor8 JS Section\n\nvar wsUrl8 = 'wss://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ws/sensor8';\n\tvar socket;\n\t\tvar temperatureData8, humidityData8;\n\t\tvar temperatureOptions8, humidityOptions8;\n\t\tvar temperatureChart8, humidityChart8;\n\n\t// Google Gauge\n\t\tgoogle.load(\"visualization\", \"1\", {packages:[\"gauge\"]});\n\t\tgoogle.setOnLoadCallback(drawChart8);\n\t\tfunction drawChart8() {\n\n\t// Data for Sensor8 temperature chart\n\ttemperatureData8 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor8', 0],\n\t\t]);\n\n\t// Data for Sensor8 humidity chart\n\thumidityData8 = google.visualization.arrayToDataTable([\n\t\t['Label', 'Value'],\n\t\t['Sensor8', 0]\n\t\t]);\n\n\t// Option for Sensor8 temperature chart\n\ttemperatureOptions8 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 20, max: 30,\n\t\tredFrom: 28, redTo: 30,\n\t\tgreenFrom: 20, greenTo: 25,\n\t\tyellowFrom:25, yellowTo: 28,\n\t\tminorTicks: 10\n\t\t};\n\n\t// Option for Sensor8 humidity chart\n\thumidityOptions8 = {\n\t\twidth: 200, height: 200,\n\t\tmin: 0, max: 100,\n\t\tredFrom: 75, redTo: 100,\n\t\tgreenFrom: 40, greenTo: 60,\n\t\tyellowFrom:60, yellowTo: 75,\n\t\tminorTicks: 10\n\t\t};\n\n\n\ttemperatureChart8 = new google.visualization.Gauge(document.getElementById('temperatureChart8'));\n\thumidityChart8 = new google.visualization.Gauge(document.getElementById('humidityChart8'));\n\n\ttemperatureChart8.draw(temperatureData8, temperatureOptions8);\n\thumidityChart8.draw(humidityData8, humidityOptions8);\n\n\t};\n\n// Sensor1 Websocket Connect and Close\n      \nfunction connect1() {\n\tsocket = new WebSocket(wsUrl1);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update temperature data\n\ttemperatureData1.setValue(0, 1, sensorData.temp);\n\n\t// Update humidity data\n\thumidityData1.setValue(0, 1, sensorData.humidity);\n\n\ttemperatureChart1.draw(temperatureData1, temperatureOptions1);\n\thumidityChart1.draw(humidityData1, humidityOptions1);\n\n\t};\n};\n      \nfunction disconnect1() {\n\tsocket.close();\n};\n\n// Sensor2 Websocket Connect and Close\n      \nfunction connect2() {\n\tsocket = new WebSocket(wsUrl2);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor2 temperature data\n\ttemperatureData2.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor2 humidity data\n\thumidityData2.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart2.draw(temperatureData2, temperatureOptions2);\n\thumidityChart2.draw(humidityData2, humidityOptions2);\n\n\t};\n};\n\nfunction disconnect2() {\n\tsocket.close();\n};\n\n// Sensor3 Websocket Connect and Close\n      \nfunction connect3() {\n\tsocket = new WebSocket(wsUrl3);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor3 temperature data\n\ttemperatureData3.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor3 humidity data\n\thumidityData3.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart3.draw(temperatureData3, temperatureOptions3);\n\thumidityChart3.draw(humidityData3, humidityOptions3);\n\n\t};\n};\n\nfunction disconnect3() {\n\tsocket.close();\n};\n\n// Sensor4 Websocket Connect and Close\n      \nfunction connect4() {\n\tsocket = new WebSocket(wsUrl4);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor4 temperature data\n\ttemperatureData4.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor4 humidity data\n\thumidityData4.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart4.draw(temperatureData4, temperatureOptions4);\n\thumidityChart4.draw(humidityData4, humidityOptions4);\n\n\t};\n};\n\nfunction disconnect4() {\n\tsocket.close();\n};\n\n// Sensor5 Websocket Connect and Close\n      \nfunction connect5() {\n\tsocket = new WebSocket(wsUrl5);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor5 temperature data\n\ttemperatureData5.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor5 humidity data\n\thumidityData5.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart5.draw(temperatureData5, temperatureOptions5);\n\thumidityChart5.draw(humidityData5, humidityOptions5);\n\n\t};\n};\n\nfunction disconnect5() {\n\tsocket.close();\n};\n\n// Sensor6 Websocket Connect and Close\n      \nfunction connect6() {\n\tsocket = new WebSocket(wsUrl6);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor6 temperature data\n\ttemperatureData6.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor6 humidity data\n\thumidityData6.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart6.draw(temperatureData6, temperatureOptions6);\n\thumidityChart6.draw(humidityData6, humidityOptions6);\n\n\t};\n};\n\nfunction disconnect6() {\n\tsocket.close();\n};\n\n// Sensor7 Websocket Connect and Close\n      \nfunction connect7() {\n\tsocket = new WebSocket(wsUrl7);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor7 temperature data\n\ttemperatureData7.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor7 humidity data\n\thumidityData7.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart7.draw(temperatureData7, temperatureOptions7);\n\thumidityChart7.draw(humidityData7, humidityOptions7);\n\n\t};\n};\n\nfunction disconnect7() {\n\tsocket.close();\n};\n\n// Sensor8 Websocket Connect and Close\n      \nfunction connect8() {\n\tsocket = new WebSocket(wsUrl8);\n\tsocket.onmessage = function(e) {\n\tvar sensorData = JSON.parse(e.data);\n\n\t// Update Sensor8 temperature data\n\ttemperatureData8.setValue(0, 1, sensorData.temp);\n\n\t// Update Sensor8 humidity data\n\thumidityData8.setValue(0, 1, sensorData.humidity);\n\n\n\ttemperatureChart8.draw(temperatureData8, temperatureOptions8);\n\thumidityChart8.draw(humidityData8, humidityOptions8);\n\n\t};\n};\n\nfunction disconnect8() {\n\tsocket.close();\n};\n\n</script>\n\n</head>\n\n<body>\n<div>\n<!-- <div class=\"container\"> --> \n\t<h1> K5 IoT Sample App <small>< Realtime Meter with Websocket ></small></h1>\n</div>  \n\n<br>\n<h3>■ Websocket 接続 ■</h3>\n<div>\n\t<br><button onclick=\"connect1()\">Connect Sensor1</button></br>\n\t<br><button onclick=\"connect2()\">Connect Sensor2</button></br>\n\t<br><button onclick=\"connect3()\">Connect Sensor3</button></br>\n\t<br><button onclick=\"connect4()\">Connect Sensor4</button></br>\n\t<br><button onclick=\"connect5()\">Connect Sensor5</button></br>\n\t<br><button onclick=\"connect6()\">Connect Sensor5</button></br>\n\t<br><button onclick=\"connect7()\">Connect Sensor7</button></br>\n\t<br><button onclick=\"connect8()\">Connect Sensor8</button></br>\n</div>\n</br>\n<h3>■ Websocket 切断 ■</h3>\n<div>\n\t<br><button onclick=\"disconnect1()\">Disconnect Sensor1</button></br>\n\t<br><button onclick=\"disconnect2()\">Disconnect Sensor2</button></br>\n\t<br><button onclick=\"disconnect3()\">Disconnect Sensor3</button></br>\n\t<br><button onclick=\"disconnect4()\">Disconnect Sensor4</button></br>\n\t<br><button onclick=\"disconnect5()\">Disconnect Sensor5</button></br>\n\t<br><button onclick=\"disconnect6()\">Disconnect Sensor6</button></br>\n\t<br><button onclick=\"disconnect7()\">Disconnect Sensor7</button></br>\n\t<br><button onclick=\"disconnect8()\">Disconnect Sensor8</button></br>\n</div>\n<br>\n<h1>■ Temperature ■</h1>\n<div>\n\t<div id=\"temperatureChart1\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart2\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart3\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart4\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart5\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart6\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart7\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"temperatureChart8\" style=\"width: 200px; height: 200px; float:left;\"></div>\n</div>\n<br><br><br><br><br><br><br><br><br><br><br><br><br>\n<h1>■ Humidity ■</h1>\n<div>\n\t<div id=\"humidityChart1\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart2\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart3\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart4\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart5\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart6\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart7\" style=\"width: 200px; height: 200px; float:left;\"></div>\n\t<div id=\"humidityChart8\" style=\"width: 200px; height: 200px; float:left;\"></div>\n</div>\n\n</body>\n</html>","x":329.75000762939453,"y":1528.7500257492065,"z":"cdc0c767.e028d8","wires":[["f9333cb8.04c2b"]]},{"id":"f9333cb8.04c2b","type":"http response","name":"","x":521.7500076293945,"y":1528.7500257492065,"z":"cdc0c767.e028d8","wires":[]},{"id":"ff1f7cc2.e65fa","type":"websocket out","name":"/ws/sensor3","server":"437ce790.863708","client":"","x":297.61106872558594,"y":1099.7500553131104,"z":"cdc0c767.e028d8","wires":[]},{"id":"3da09391.aa570c","type":"websocket out","name":"/ws/sensor4","server":"f45a52fa.a21f","client":"","x":298.61114501953125,"y":1139.999994277954,"z":"cdc0c767.e028d8","wires":[]},{"id":"46185412.d02fdc","type":"function","name":"Data Modify for DB Insert","func":"msg.payload = \"insert into iotdata(sensorname, date, time, timestamp, temperature, humidity) values('\" + msg.payload.sensorname + \"','\" + msg.payload.date + \"','\" + msg.payload.time + \"','\" + msg.payload.timestamp + \"','\" + msg.payload.temperature + \"','\" + msg.payload.humidity + \"');\";\n\nreturn msg;","outputs":1,"x":549.0000305175781,"y":592.5,"z":"cdc0c767.e028d8","wires":[["1e69148f.3e32fb","70b90c88.439704"]]},{"id":"6715612.73b57a","type":"inject","name":"","topic":"","payload":"true","payloadType":"none","repeat":"","crontab":"","once":false,"x":172,"y":278,"z":"1db0a15.c98455f","wires":[["5215dc8e.fd6424"]]},{"id":"f34467aa.a411e8","type":"debug","name":"","active":true,"console":"false","complete":"false","x":1012,"y":278,"z":"1db0a15.c98455f","wires":[]},{"id":"fb9fdbfa.4f0218","type":"http request","name":"REST API GET","method":"GET","ret":"obj","url":"http://api.trial2.iot.jp.fujitsu.com/v1/ITP314-001/DTC/TEST2/_past","x":702,"y":278,"z":"1db0a15.c98455f","wires":[["f34467aa.a411e8","3296c0de.87395"]]},{"id":"5215dc8e.fd6424","type":"template","name":"認証情報付与","field":"headers.Authorization","template":"Bearer testcode2","x":422,"y":278,"z":"1db0a15.c98455f","wires":[["fb9fdbfa.4f0218"]]},{"id":"46194d60.2814f4","type":"http request","name":"データ追加 [REST API]","method":"PUT","ret":"txt","url":"http://api.trial2.iot.jp.fujitsu.com/v1/ITP314-001/DTC/TEST2","x":932,"y":462,"z":"1db0a15.c98455f","wires":[["e8236351.051a5"]]},{"id":"9037393e.a738c8","type":"template","name":"投入データ [JSON]","field":"payload","template":"{\"date\":\"20170626T13:39:00Z\",\"sensorname\":\"Sensor3\",\"location\":\"ServerRack3\",\"moisture\":45,\"temperature\":25}","x":552,"y":462,"z":"1db0a15.c98455f","wires":[["bd199321.eacbd"]]},{"id":"ad93e770.77c1c8","type":"inject","name":"","topic":"","payload":"true","payloadType":"none","repeat":"","crontab":"","once":false,"x":172,"y":462,"z":"1db0a15.c98455f","wires":[["bdc5ab40.c66bd8"]]},{"id":"bdc5ab40.c66bd8","type":"template","name":"認証情報付与","field":"headers.Authorization","template":"Bearer testcode2","x":342,"y":462,"z":"1db0a15.c98455f","wires":[["9037393e.a738c8"]]},{"id":"e8236351.051a5","type":"debug","name":"","active":false,"console":"false","complete":"false","x":1132,"y":462,"z":"1db0a15.c98455f","wires":[]},{"id":"bd199321.eacbd","type":"json","name":"","x":732,"y":462,"z":"1db0a15.c98455f","wires":[["c2bcc616.d29318","46194d60.2814f4"]]},{"id":"c2bcc616.d29318","type":"debug","name":"","active":false,"console":"false","complete":"false","x":892,"y":522,"z":"1db0a15.c98455f","wires":[]},{"id":"df74a38e.72316","type":"function","name":"ダミーデータ生成（センサー3）","func":"var getTimestamp = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2) + 'T';\nts += (\"0\"+date.getHours()).slice(-2) + ':';\nts += (\"0\"+date.getMinutes()).slice(-2) + ':';\nts += (\"0\"+date.getSeconds()).slice(-2) + 'Z';\n\nreturn ts;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor3\";\n\n// Object of place\nvar location1 = \"ServerRack3\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n    \"location\": location1,\n    \"date\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 30 + 25)*100)/100 ,\n    \"moisture\": Math.floor(( Math.random() * 71 + 30)*100)/100\n};\nreturn msg;\n","outputs":1,"x":402,"y":582,"z":"1db0a15.c98455f","wires":[["fb6f8a04.f832c8"]]},{"id":"db566b13.9d39b8","type":"inject","name":"","topic":"","payload":"true","payloadType":"none","repeat":"","crontab":"","once":false,"x":172,"y":582,"z":"1db0a15.c98455f","wires":[["df74a38e.72316"]]},{"id":"fb6f8a04.f832c8","type":"template","name":"認証情報付与","field":"headers.Authorization","template":"Bearer testcode2","x":662,"y":582,"z":"1db0a15.c98455f","wires":[["15385cd4.c1feb3","ab1d050e.997788"]]},{"id":"ab1d050e.997788","type":"http request","name":"データ追加 [REST API]","method":"PUT","ret":"txt","url":"http://api.trial2.iot.jp.fujitsu.com/v1/ITP314-001/DTC/TEST2","x":912,"y":582,"z":"1db0a15.c98455f","wires":[["57840b4b.378cf4"]]},{"id":"57840b4b.378cf4","type":"debug","name":"","active":false,"console":"false","complete":"false","x":1132,"y":582,"z":"1db0a15.c98455f","wires":[]},{"id":"15385cd4.c1feb3","type":"debug","name":"","active":false,"console":"false","complete":"false","x":872,"y":642,"z":"1db0a15.c98455f","wires":[]},{"id":"18b8baae.4d8aa5","type":"comment","name":"REST API GET","info":"","x":182,"y":238,"z":"1db0a15.c98455f","wires":[]},{"id":"ada1ff53.c291a","type":"comment","name":"REST API PUT","info":"","x":182,"y":422,"z":"1db0a15.c98455f","wires":[]},{"id":"16b2fb02.15baf5","type":"comment","name":"REST API Random Data PUT","info":"","x":222,"y":542,"z":"1db0a15.c98455f","wires":[]},{"id":"ba23c6e9.05b2d8","type":"http in","name":"","url":"/api_get","method":"get","x":187,"y":331,"z":"1db0a15.c98455f","wires":[["5215dc8e.fd6424"]]},{"id":"3296c0de.87395","type":"http response","name":"","x":995,"y":325,"z":"1db0a15.c98455f","wires":[]},{"id":"4a2849a2.ebbfe8","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor1 Temperature 1 hour","group":"sensor1 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1214.250015258789,"y":698.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"28d7a0e6.6d372","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor1 Realtime Temp Gauge","group":"sensor1 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1225.500015258789,"y":808.5000143051147,"z":"cdc0c767.e028d8","wires":[]},{"id":"5c144d36.679e14","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor1 Temperature 12 hours","group":"sensor1 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1221.250015258789,"y":734.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"b2602b9.3cae3d8","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor1 Temperature 1week","group":"sensor1 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1216.250015258789,"y":770.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"126c2740.00f619","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor2 Temperature 1 hour","group":"sensor2 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1217.250015258789,"y":848.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"ef1e423d.f6efe","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor2 Realtime Temp Gauge","group":"sensor2 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1230.000015258789,"y":963.2500171661377,"z":"cdc0c767.e028d8","wires":[]},{"id":"a794b498.36eb08","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor2 Temperature 12 hours","group":"sensor2 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1225.250015258789,"y":886.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"f8cad88c.f91b28","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor2 Temperature 1week","group":"sensor2 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1219.250015258789,"y":924.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"af28593a.d48d08","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor3 Temperature 1 hour","group":"sensor3 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1219.250015258789,"y":1003.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"d5d3f48d.c43978","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor3 Realtime Temp Gauge","group":"sensor3 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1230.750015258789,"y":1118.0000200271606,"z":"cdc0c767.e028d8","wires":[]},{"id":"71e2f59a.5f232c","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor3 Temperature 12 hours","group":"sensor3 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1228.250015258789,"y":1041.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"9c0aa407.137d28","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor3 Temperature 1week","group":"sensor3 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1221.250015258789,"y":1080.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"d21c0a38.552ab8","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor4 Temperature 1 hour","group":"sensor4 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1223.250015258789,"y":1157.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"516299c2.6adea8","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor4 Realtime Temp Gauge","group":"sensor4 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1236.750015258789,"y":1271.2500219345093,"z":"cdc0c767.e028d8","wires":[]},{"id":"b18eb1ef.13738","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor4 Temperature 12 hours","group":"sensor4 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1232.250015258789,"y":1195.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"a6d745f.7f784b8","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor4 Temperature 1week","group":"sensor4 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1226.250015258789,"y":1233.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"1431f278.a3882e","type":"http in","name":"GET /dash","url":"/dash","method":"get","x":116.75000762939453,"y":1570.2500257492065,"z":"cdc0c767.e028d8","wires":[["dc38f365.73108"]]},{"id":"dc38f365.73108","type":"template","name":"Redirect URL","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/css/tabulator.min.css\">\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script> \n\t<script type=\"text/javascript\" src=\"https://www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/fancytree/dist/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/js/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n</head>\n<body>\n\n<h1><span style = 'color:red; font-size:100%; font-weight:bold; font-family: serif;'>■ K5 IoT Platform Visualization Sample ■</span></h1>\n<br>\n\n<p>■ 設置センサー 一覧 ■</p>\n\n<br>\n<div id=\"example-table\" style=\"width: 60%;\"></div>\n<br>\n\n<!--\n<br>\n<div id=\"table_div\" style=\"width: 100%; \"></div>\n<br>\n-->\n\n<!--\n<style type='text/css'>\n  .bold-green-font {\n    font-weight: bold;\n    color: green;\n  }\n\n  .bold-font {\n    font-weight: bold;\n  }\n\n  .right-text {\n    text-align: right;\n  }\n\n  .large-font {\n    font-size: 20px;\n  }\n\n  .italic-darkblue-font {\n    font-style: italic;\n    color: darkblue;\n  }\n\n  .italic-purple-font {\n    font-style: italic;\n    color: purple;\n  }\n\n  .underline-blue-font {\n    text-decoration: underline;\n    color: blue;\n  }\n\n  .gold-border {\n    border: 3px solid gold;\n  }\n\n  .deeppink-border {\n    border: 3px solid deeppink;\n  }\n\n  .orange-background {\n    background-color: orange;\n  }\n\n  .orchid-background {\n    background-color: orchid;\n  }\n\n  .beige-background {\n    background-color: beige;\n  }\n\n</style>\n-->\n\n<script>\n\n$(\"#example-table\").tabulator({\n\tcolumns:[\n\t\t{title:\"SensorName\", field:\"sensorname\", sortable:true, width:100},\n\t\t{title:\"Room\", field:\"room\", sortable:true, sorter:\"string\", width:200},\n\t\t{title:\"Location\", field:\"location\", sortable:true, sorter:\"string\", width:200},\n\t\t{title:\"Registration Date\", field:\"date\", sortable:true, width:150},\n\t\t{title:\"Comment\", field:\"comment\", sortable:false, width:500},\n\t],\n});\n\n$(\"#example-table\").tabulator(\"setData\", \"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/api1/v1/sensor_data/all\");\n\n$(window).resize(function(){\n\t$(\"#example-table\").tabulator(\"redraw\");\n});\n\n\n//google.load('visualization', '1', {packages:['table']});\n//google.setOnLoadCallback(drawTable);\n\n//function drawTable() {\n\n//\tvar cssClassNames = {\n//\t\t'headerRow': 'italic-darkblue-font large-font bold-font',\n//\t\t'tableRow': '',\n//\t\t'oddTableRow': 'beige-background',\n//\t\t'selectedTableRow': 'orange-background large-font',\n//\t\t'hoverTableRow': '',\n//\t\t'headerCell': 'gold-border',\n//\t\t'tableCell': '',\n//\t\t'rowNumberCell': 'underline-blue-font'\n//\t\t};\n\n//var options = {'showRowNumber': true, 'allowHtml': true, 'cssClassNames': cssClassNames};\n\n//var data = new google.visualization.DataTable();\n//\tdata.addColumn('string', 'Location');\n//\tdata.addColumn('string', 'Rack Name');\n//\tdata.addColumn('string', 'Sensor Name');\n//\tdata.addColumn('boolean', 'Status');\n//\tdata.addColumn('string', 'Temperature');\n//\tdata.addColumn('string', 'Humidity');\n//\tdata.addColumn('string', 'Battery Change Date');\n//\tdata.addRows([\n//\t\t['29F Server Room A','Server Rack No1','Sensor1',true,'26.12','54.31','2017/06/26' ],\n//\t\t['29F Server Room A','Server Rack No3','Sensor2',true,'27.23','56.44','2017/05/20' ],\n//\t\t['29F Server Room B','Server Rack No2','Sensor3',false,'25.22','53.22','2017/04/14' ],\n//\t\t['29F Server Room C','Server Rack No1','Sensor4',true,'26.89','54.19','2017/06/20' ],\n//\t\t['29F Server Room D','Server Rack No4','Sensor5',true,'25.11','58.36','2017/05/10' ],\n//\t\t['29F Server Room E','Server Rack No8','Sensor6',false,'23.34','51.22','2017/04/12' ],\n//\t\t['29F Server Room E','Server Rack No4','Sensor6',true,'24.21','50.12','2017/04/12' ],\n//\t\t['29F Server Room E','Server Rack No5','Sensor6',true,'23.86','48.31','2017/04/12' ]\n//\t\t]);\n\n//var table = new google.visualization.Table(document.getElementById('table_div'));\n//\ttable.draw(data, {showRowNumber: true});\n//}\n\nfunction goTop1(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/1\");\n}\nfunction goTop2(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/5\");\n}\nfunction goTop3(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/0\");\n}\nfunction goTop4(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/2\");\n}\nfunction goTop5(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/3\");\n}\nfunction goTop6(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/4\");\n}\nfunction goTop7(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/6\");\n}\nfunction goTop8(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/ui/#/7\");\n}\nfunction goTop9(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/sensor\");\n}\nfunction goTop10(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/csv_get\");\n}\nfunction goTop11(){\n  location.href=(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/sensor_info\");\n}\n\n</script>\n\n<form>\n<p> ■周辺温度ダッシュボード■</p>\n\n<br>\n<input type=\"button\" value=\"温度ステータス\" onclick=\"goTop1()\">\n</br>\n<br>\n\n<p> ■湿度ダッシュボード■ </p>\n<br>\n<input type=\"button\" value=\"湿度ステータス\" onclick=\"goTop2()\">\n</br>\n<br>\n<p> ■周辺温度グラフチャート■</p>\n<br>\n<input type=\"button\" value=\"1時間温度推移グラフ\" onclick=\"goTop3()\">\n</br>\n<br>\n<input type=\"button\" value=\"12時間温度推移グラフ\" onclick=\"goTop4()\">\n</br>\n<br>\n<input type=\"button\" value=\"1週間温度推移グラフ\" onclick=\"goTop5()\">\n</br>\n<br>\n<p> ■湿度グラフチャート■</p>\n<br>\n<input type=\"button\" value=\"1時間湿度推移グラフ\" onclick=\"goTop6()\">\n</br>\n<br>\n<input type=\"button\" value=\"12時間湿度推移グラフ\" onclick=\"goTop7()\">\n</br>\n<br>\n<input type=\"button\" value=\"1週間湿度推移グラフ\" onclick=\"goTop8()\">\n</br>\n<br>\n<p> ■温湿度ゲージ■</p>\n<br>\n<input type=\"button\" value=\"温湿度ゲージメーター表示\" onclick=\"goTop9()\">\n</br>\n<br>\n<p> ■CSVファイルダウンロード■</p>\n<br>\n<input type=\"button\" value=\"CSVダウンロード\" onclick=\"goTop10()\">\n</br>\n<br>\n<p> ■センサー管理メニュー■</p>\n<br>\n<input type=\"button\" value=\"センサー管理\" onclick=\"goTop11()\">\n</br>\n</form>\n\n\n\n\n</body>\n</html>\n","x":310.75001525878906,"y":1571.5000257492065,"z":"cdc0c767.e028d8","wires":[["b9e56397.be8e7"]]},{"id":"b9e56397.be8e7","type":"http response","name":"","x":521.0000152587891,"y":1572.7500247955322,"z":"cdc0c767.e028d8","wires":[]},{"id":"c2903fc4.2337c","type":"function","name":"Sensor1 Humid Payload","func":"return {payload:msg.payload.humidity};","outputs":1,"x":652.75,"y":868.9999942779541,"z":"cdc0c767.e028d8","wires":[["dc21ba52.a9b0f8","9d98fac2.b98ad8","9b4ba558.85b6c8","9b43bd69.f4692"]]},{"id":"c82a8176.f40f1","type":"function","name":"Sensor2 Humid Payload","func":"return {payload:msg.payload.humidity};\n","outputs":1,"x":651.2222480773926,"y":908.7500972747803,"z":"cdc0c767.e028d8","wires":[["12710821.ac8c78","3f0a9b85.59c094","c48543e1.6edea","f96b4852.8855d8"]]},{"id":"77f8001.98c4","type":"function","name":"Sensor3 Humid Payload","func":"return {payload:msg.payload.humidity};","outputs":1,"x":652.9166870117188,"y":949.1667423248291,"z":"cdc0c767.e028d8","wires":[["fcaf615b.b6eb9","4748b1de.53504","de15519c.399c4","b64f5753.d90508"]]},{"id":"cd4abf1e.15a2e","type":"function","name":"Sensor4 Humid Payload","func":"return {payload:msg.payload.humidity};","outputs":1,"x":652.611083984375,"y":990.6389713287354,"z":"cdc0c767.e028d8","wires":[["da281257.06248","3edb12ce.c3858e","c570762e.d74f78","cbc28c3c.6dc87"]]},{"id":"dc21ba52.a9b0f8","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor1 Humidity 1 hour","group":"sensor1 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1217.250015258789,"y":1314.2500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"9b43bd69.f4692","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor1 Realtime Humidity Gauge","group":"sensor1 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1251.750015258789,"y":1427.250023841858,"z":"cdc0c767.e028d8","wires":[]},{"id":"9d98fac2.b98ad8","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor1 Humidity 12 hours","group":"sensor1 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1226.2500190734863,"y":1354.2500162124634,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"9b4ba558.85b6c8","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor1 Humidity 1week","group":"sensor1 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1221.2500190734863,"y":1390.2500162124634,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"3f0a9b85.59c094","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor2 Humidity 1 hour","group":"sensor2 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1222.2500190734863,"y":1467.0000171661377,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"12710821.ac8c78","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor2 Realtime Humidity Gauge","group":"sensor2 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1257.500015258789,"y":1582.0000257492065,"z":"cdc0c767.e028d8","wires":[]},{"id":"c48543e1.6edea","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor2 Humidity 12 hours","group":"sensor2 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1234.0000228881836,"y":1506.250018119812,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"f96b4852.8855d8","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor2 Humidity 1week","group":"sensor2 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1228.0000228881836,"y":1544.250018119812,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"4748b1de.53504","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor3 Humidity 1 hour","group":"sensor3 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1225.5000228881836,"y":1623.2500190734863,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"fcaf615b.b6eb9","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor3 Realtime Humidity Gauge","group":"sensor3 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1260.750015258789,"y":1736.7500286102295,"z":"cdc0c767.e028d8","wires":[]},{"id":"de15519c.399c4","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor3 Humidity 12 hours","group":"sensor3 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1234.5000228881836,"y":1661.2500200271606,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"b64f5753.d90508","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor3 Humidity 1week","group":"sensor3 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1227.5000228881836,"y":1700.2500200271606,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"3edb12ce.c3858e","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor4 Humidity 1 hour","group":"sensor4 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1229.5000228881836,"y":1777.2500219345093,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"da281257.06248","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor4 Realtime Humidity Gauge","group":"sensor4 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1259.250015258789,"y":1891.2500314712524,"z":"cdc0c767.e028d8","wires":[]},{"id":"c570762e.d74f78","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor4 Humidity 12 hours","group":"sensor4 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1237.250015258789,"y":1815.2500219345093,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"cbc28c3c.6dc87","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor4 Humidity 1week","group":"sensor4 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1228.7500228881836,"y":1853.250023841858,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"d76808.aa7fe7f8","type":"http in","name":"","url":"/csv_get","method":"get","x":126.25000762939453,"y":1653.0000047683716,"z":"cdc0c767.e028d8","wires":[["11464056.b5bfd"]]},{"id":"11464056.b5bfd","type":"file in","name":"","filename":"test_20170707.csv","format":"","x":331.25001525878906,"y":1653.0000257492065,"z":"cdc0c767.e028d8","wires":[["b0b99040.f9961"]]},{"id":"b0b99040.f9961","type":"http response","name":"","x":526.2500076293945,"y":1654.2500047683716,"z":"cdc0c767.e028d8","wires":[]},{"id":"e2796837.81d1c8","type":"http in","name":"","url":"/download","method":"get","x":107.50000762939453,"y":1613.0000047683716,"z":"cdc0c767.e028d8","wires":[["cb2a66b2.b20058"]]},{"id":"cb2a66b2.b20058","type":"template","name":"CSV Download","field":"payload","template":"<!doctype html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <title>Download Sample</title>\n    </head>\n    <body>\n        <script type='text/javascript'>\n            function handleDownload() {\n                var content = 'あいうえお';\n                var blob = new Blob([ content ], { \"type\" : \"text/plain\" });\n\n                if (window.navigator.msSaveBlob) { \n                    window.navigator.msSaveBlob(blob, \"test.txt\"); \n\n                    // msSaveOrOpenBlobの場合はファイルを保存せずに開ける\n                    window.navigator.msSaveOrOpenBlob(blob, \"test.txt\"); \n                } else {\n                    document.getElementById(\"download\").href = window.URL.createObjectURL(blob);\n                }\n            }\n        </script>\n        <a id=\"download\" href=\"#\" download=\"test.txt\" onclick=\"handleDownload()\">ダウンロード</a>\n    </body>\n</html>","x":317.50001525878906,"y":1614.2500257492065,"z":"cdc0c767.e028d8","wires":[["48c002c1.32811c"]]},{"id":"48c002c1.32811c","type":"http response","name":"","x":533.7500076293945,"y":1620.5000047683716,"z":"cdc0c767.e028d8","wires":[]},{"id":"b8772a84.022968","type":"function","name":"Create Table iotdata","func":"msg.payload = \"create table iotdata (sensorname varchar(20), date date, time time, temperature real, humidity real);\";\n\nreturn msg;","outputs":1,"x":371.25,"y":690,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"8391002e.a62b6","type":"function","name":"Create dummy rundom data for Sensor5","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor5\";\n\n// Object of place\nvar location1 = \"ServerRack5\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":388,"y":287,"z":"cdc0c767.e028d8","wires":[["fb9d29e4.9f2418","ed6a0e8f.5552"]]},{"id":"49148932.266d28","type":"function","name":"Create dummy rundom data for Sensor6","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor6\";\n\n// Object of place\nvar location1 = \"ServerRack6\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":388,"y":323,"z":"cdc0c767.e028d8","wires":[["fb9d29e4.9f2418","ed6a0e8f.5552"]]},{"id":"f44908a7.a470e8","type":"function","name":"Create dummy rundom data for Sensor7","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor7\";\n\n// Object of place\nvar location1 = \"ServerRack7\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":389,"y":362,"z":"cdc0c767.e028d8","wires":[["fb9d29e4.9f2418","ed6a0e8f.5552"]]},{"id":"67f70e84.63db5","type":"function","name":"Create dummy rundom data for Sensor8","func":"var getTimestamp = function () {\n    var date = new Date();\n    date.setHours(date.getHours() + 9);\n    var dt = date.getFullYear() + '-';\n    dt += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\n    dt += (\"0\"+date.getDate()).slice(-2) + 'T';\n    dt += (\"0\"+date.getHours()).slice(-2) + ':';\n    dt += (\"0\"+date.getMinutes()).slice(-2) + ':';\n    dt += (\"0\"+date.getSeconds()).slice(-2) + '+09:00';\n    return dt;\n}\n\nvar getTimestampD = function () {\nvar date = new Date();\ndate.setHours(date.getHours() + 9);\n\nvar ts = date.getFullYear() + '-';\nts += (\"0\"+(date.getMonth()+1)).slice(-2) + '-';\nts += (\"0\"+date.getDate()).slice(-2);\n\nreturn ts;\n};\n\nvar getTimestampT = function () {\nvar hour = new Date();\nhour.setHours(hour.getHours() +9);\n\nvar hr = (\"0\"+hour.getHours()).slice(-2) + ':';\nhr += (\"0\"+hour.getMinutes()).slice(-2) + ':';\nhr += (\"0\"+hour.getSeconds()).slice(-2);\n\nreturn hr;\n};\n\n// Object of SensorName\nvar name1 = \"Sensor8\";\n\n// Object of place\nvar location1 = \"ServerRack8\"\n\n\nmsg.payload={\n    \"sensorname\": name1,\n//    \"location\": location1,\n    \"date\": getTimestampD(),\n    \"time\": getTimestampT(),\n    \"timestamp\": getTimestamp(),\n    \"temperature\": Math.floor((Math.random() * 9 + 20)*100)/100 ,\n    \"humidity\": Math.floor(( Math.random() * 15 + 40)*100)/100\n};\nreturn msg;","outputs":1,"x":389,"y":399,"z":"cdc0c767.e028d8","wires":[["fb9d29e4.9f2418","ed6a0e8f.5552"]]},{"id":"b3c5337c.a8ded","type":"websocket out","name":"/ws/sensor5","server":"54192100.1d709","client":"","x":300.1666564941406,"y":1180,"z":"cdc0c767.e028d8","wires":[]},{"id":"113065e5.5ea87a","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":132.61111450195312,"y":1178.9998931884766,"z":"cdc0c767.e028d8","wires":[["b3c5337c.a8ded"]]},{"id":"c41412af.1bfaa","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":132.5,"y":1219.444387435913,"z":"cdc0c767.e028d8","wires":[["8da18557.2d15c8"]]},{"id":"48c5ecb0.231d04","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":134.5,"y":1261.444387435913,"z":"cdc0c767.e028d8","wires":[["10f0dbde.bd1234"]]},{"id":"a83c2da9.da1f2","type":"function","name":"Data Modify","func":"msg.payload =  {\n    \"temp\": msg.payload.temperature,\n    \"humidity\": msg.payload.humidity\n};\n\nreturn msg;","outputs":1,"x":135.38888549804688,"y":1301.22216796875,"z":"cdc0c767.e028d8","wires":[["6a0b3c3a.382c44"]]},{"id":"8da18557.2d15c8","type":"websocket out","name":"/ws/sensor6","server":"5945612.f2a34a","client":"","x":300.2777862548828,"y":1220.333293914795,"z":"cdc0c767.e028d8","wires":[]},{"id":"10f0dbde.bd1234","type":"websocket out","name":"/ws/sensor7","server":"13fa2ec7.0e6081","client":"","x":302.02772521972656,"y":1261.0833129882812,"z":"cdc0c767.e028d8","wires":[]},{"id":"6a0b3c3a.382c44","type":"websocket out","name":"/ws/sensor8","server":"7bf18ae5.ceac64","client":"","x":303.0278015136719,"y":1301.333251953125,"z":"cdc0c767.e028d8","wires":[]},{"id":"79fa325.30cddcc","type":"function","name":"Sensor5 Temp Payload","func":"return {payload:msg.payload.temperature};","outputs":1,"x":651.25,"y":1032.5,"z":"cdc0c767.e028d8","wires":[["36f4b7fc.24abd8","e6f701bb.d768","fffe4558.774388","ba8bae32.c325f"]]},{"id":"cb977d9e.a866e","type":"function","name":"Sensor6 Temp Payload","func":"return {payload:msg.payload.temperature};\n","outputs":1,"x":649.7222480773926,"y":1072.2501029968262,"z":"cdc0c767.e028d8","wires":[["d3bb208a.fa3ce","68528b1.3897a74","7908e1d.fd4592","12558a7f.cb14e6"]]},{"id":"7496c95b.d83848","type":"function","name":"Sensor7 Temp Payload","func":"return {payload:msg.payload.temperature};","outputs":1,"x":650.1667022705078,"y":1111.4167652130127,"z":"cdc0c767.e028d8","wires":[["5e61e33e.fe2d3c","e221500e.30474","ef20a269.32699","36b352c0.73599e"]]},{"id":"a58c8bff.0551d8","type":"function","name":"Sensor8 Temp Payload","func":"return {payload:msg.payload.temperature};","outputs":1,"x":651.111083984375,"y":1154.1389770507812,"z":"cdc0c767.e028d8","wires":[["1e479d0.3046963","59da523.fdef4ac","5bbba460.f1eb6c","5a7ac959.01c6d8"]]},{"id":"454bbdb4.4d7914","type":"function","name":"Sensor5 Humid Payload","func":"return {payload:msg.payload.humidity};","outputs":1,"x":652.5555419921875,"y":1196.3333740234375,"z":"cdc0c767.e028d8","wires":[["31dd3fc1.00bc8","bebb8836.89a368","920f8a7.0a34c78","9c763dd.04f3ac"]]},{"id":"2525030b.6766fc","type":"function","name":"Sensor6 Humid Payload","func":"return {payload:msg.payload.humidity};\n","outputs":1,"x":651.0277900695801,"y":1236.0834770202637,"z":"cdc0c767.e028d8","wires":[["4d855bf7.04ae74","5dddda0b.bd6ea4","cf32b47e.cae2a8","28612991.e89c86"]]},{"id":"707604a1.90909c","type":"function","name":"Sensor7 Humid Payload","func":"return {payload:msg.payload.humidity};","outputs":1,"x":652.7222290039062,"y":1276.5001220703125,"z":"cdc0c767.e028d8","wires":[["48bcb9e0.7caad8","6c889a94.847564","91cde3ec.cc392","1514926e.806a4e"]]},{"id":"a4575b4f.4e4f58","type":"function","name":"Sensor8 Humid Payload","func":"return {payload:msg.payload.humidity};","outputs":1,"x":652.4166259765625,"y":1317.9723510742188,"z":"cdc0c767.e028d8","wires":[["19768d27.b4dc43","4d85cb94.e45f14","b3ce12fe.65ac5","ccfe243d.2f2df8"]]},{"id":"36f4b7fc.24abd8","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor5 Temperature 1 hour","group":"sensor5 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1526.2500228881836,"y":698.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"ba8bae32.c325f","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor5 Realtime Temp Gauge","group":"sensor5 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1537.5000228881836,"y":809.0000143051147,"z":"cdc0c767.e028d8","wires":[]},{"id":"e6f701bb.d768","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor5 Temperature 12 hours","group":"sensor5 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1533.2500228881836,"y":734.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"fffe4558.774388","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor5 Temperature 1week","group":"sensor5 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1528.2500228881836,"y":770.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"d3bb208a.fa3ce","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor6 Temperature 1 hour","group":"sensor6 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1529.2500228881836,"y":848.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"12558a7f.cb14e6","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor6 Realtime Temp Gauge","group":"sensor6 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1542.0000228881836,"y":963.7500171661377,"z":"cdc0c767.e028d8","wires":[]},{"id":"68528b1.3897a74","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor6 Temperature 12 hours","group":"sensor6 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1537.2500228881836,"y":886.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"7908e1d.fd4592","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor6 Temperature 1week","group":"sensor6 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1531.2500228881836,"y":924.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"5e61e33e.fe2d3c","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor7 Temperature 1 hour","group":"sensor7 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1531.2500228881836,"y":1003.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"36b352c0.73599e","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor7 Realtime Temp Gauge","group":"sensor7 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1542.7500228881836,"y":1118.5000200271606,"z":"cdc0c767.e028d8","wires":[]},{"id":"e221500e.30474","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor7 Temperature 12 hours","group":"sensor7 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1540.2500228881836,"y":1041.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"ef20a269.32699","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor7 Temperature 1week","group":"sensor7 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1533.2500228881836,"y":1080.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"1e479d0.3046963","type":"ui_chart","tab":"85520cfd.6c5a3","name":"Sensor8 Temperature 1 hour","group":"sensor8 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1535.2500228881836,"y":1157.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"5a7ac959.01c6d8","type":"ui_gauge","tab":"a7aa3c6e.2da45","name":"Sensor8 Realtime Temp Gauge","group":"sensor8 Status","order":1,"format":"{{value}}℃","min":"20","max":"30","x":1548.7500228881836,"y":1271.7500219345093,"z":"cdc0c767.e028d8","wires":[]},{"id":"59da523.fdef4ac","type":"ui_chart","tab":"a09df126.e15a5","name":"Sensor8 Temperature 12 hours","group":"sensor8 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1544.2500228881836,"y":1195.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"5bbba460.f1eb6c","type":"ui_chart","tab":"3d5dc16c.f5300e","name":"Sensor8 Temperature 1week","group":"sensor8 Temperature","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1538.2500228881836,"y":1233.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"31dd3fc1.00bc8","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor5 Humidity 1 hour","group":"sensor5 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1529.2500228881836,"y":1314.7500104904175,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"9c763dd.04f3ac","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor5 Realtime Humidity Gauge","group":"sensor5 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1563.7500228881836,"y":1427.750023841858,"z":"cdc0c767.e028d8","wires":[]},{"id":"bebb8836.89a368","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor5 Humidity 12 hours","group":"sensor5 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1538.2500267028809,"y":1354.7500162124634,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"920f8a7.0a34c78","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor5 Humidity 1week","group":"sensor5 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1533.2500267028809,"y":1390.7500162124634,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"4d855bf7.04ae74","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor6 Humidity 1 hour","group":"sensor6 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1534.2500267028809,"y":1467.5000171661377,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"5dddda0b.bd6ea4","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor6 Humidity 12 hours","group":"sensor6 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1546.0000305175781,"y":1506.750018119812,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"cf32b47e.cae2a8","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor6 Humidity 1week","group":"sensor6 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1540.0000305175781,"y":1544.750018119812,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"28612991.e89c86","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor6 Realtime Humidity Gauge","group":"sensor6 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1569.5000228881836,"y":1582.5000257492065,"z":"cdc0c767.e028d8","wires":[]},{"id":"48bcb9e0.7caad8","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor7 Humidity 1 hour","group":"sensor7 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1537.5000305175781,"y":1623.7500190734863,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"6c889a94.847564","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor7 Humidity 12 hours","group":"sensor7 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1546.5000305175781,"y":1661.7500200271606,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"91cde3ec.cc392","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor7 Humidity 1week","group":"sensor7 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1539.5000305175781,"y":1700.7500200271606,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"1514926e.806a4e","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor7 Realtime Humidity Gauge","group":"sensor7 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1572.7500228881836,"y":1737.2500286102295,"z":"cdc0c767.e028d8","wires":[]},{"id":"19768d27.b4dc43","type":"ui_chart","tab":"9614aa63.ea9888","name":"Sensor8 Humidity 1 hour","group":"sensor8 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":1,"removeOlderUnit":"3600","x":1541.5000305175781,"y":1777.7500219345093,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"4d85cb94.e45f14","type":"ui_chart","tab":"a26c4963.778498","name":"Sensor8 Humidity 12 hours","group":"sensor8 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"12","removeOlderUnit":"3600","x":1549.2500228881836,"y":1815.7500219345093,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"b3ce12fe.65ac5","type":"ui_chart","tab":"b2251b3a.e88bc8","name":"Sensor8 Humidity 1week","group":"sensor8 Humidity","order":1,"interpolate":"linear","nodata":"No Data","removeOlder":"1","removeOlderUnit":"604800","x":1540.7500305175781,"y":1853.750023841858,"z":"cdc0c767.e028d8","wires":[[],[]]},{"id":"ccfe243d.2f2df8","type":"ui_gauge","tab":"aecdcf58.fb5c9","name":"Sensor8 Realtime Humidity Gauge","group":"sensor8 Status","order":1,"format":"{{value}}%","min":"40","max":"55","x":1571.2500228881836,"y":1891.7500314712524,"z":"cdc0c767.e028d8","wires":[]},{"id":"24fc6e19.901852","type":"function","name":"Select * from iotdata","func":"msg.payload = \"select * from iotdata;\";\n\nreturn msg;","outputs":1,"x":365.25,"y":982.5,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"660d6a60.5fc634","type":"comment","name":"Create Table","info":"","x":122,"y":691,"z":"1db0a15.c98455f","wires":[]},{"id":"232d65b6.a8fada","type":"function","name":"Insert into iotdata","func":"msg.payload = \"insert into iotdata(sensorname, date, time, temperature, humidity) values('Sensor4','2017-07-12','09:19:00',21.46,57.18);\";\n\nreturn msg;","outputs":1,"x":365.75,"y":1310,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"35e363a3.a700bc","type":"inject","name":"","topic":"","payload":"","payloadType":"none","repeat":"","crontab":"","once":false,"x":143.74999618530273,"y":1310.4999980926514,"z":"1db0a15.c98455f","wires":[["232d65b6.a8fada"]]},{"id":"419d675f.f23e58","type":"function","name":"Delete From Table","func":"msg.payload = \"delete from sensor_data where sensorname='';\";\n\nreturn msg;","outputs":1,"x":369,"y":1349,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"1b02f3ed.75656c","type":"inject","name":"","topic":"","payload":"","payloadType":"none","repeat":"","crontab":"","once":false,"x":144,"y":1349.5,"z":"1db0a15.c98455f","wires":[["419d675f.f23e58"]]},{"id":"1e69148f.3e32fb","type":"postgres","postgresdb":"b88098e5.2edd18","name":"postgres","output":true,"outputs":1,"x":743.25,"y":620.5,"z":"cdc0c767.e028d8","wires":[["47e08a76.e6bf44"]]},{"id":"47e08a76.e6bf44","type":"debug","name":"","active":false,"console":"false","complete":"false","x":981,"y":537.75,"z":"cdc0c767.e028d8","wires":[]},{"id":"234fc28.92d693e","type":"function","name":"Select * from pg_class","func":"msg.payload = \"select * from pg_class;\";\n\nreturn msg;","outputs":1,"x":381.91668701171875,"y":790.7777099609375,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"2a229717.949558","type":"function","name":"Select * from information_schema","func":"msg.payload = \"select * from information_schema.columns where table_name = 'sensor_data' ORDER BY ordinal_position;\";\n\nreturn msg;","outputs":1,"x":416.58331298828125,"y":827.22216796875,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"b71ec923.a35a48","type":"comment","name":"Select Tables","info":"","x":120.33331298828125,"y":780.72216796875,"z":"1db0a15.c98455f","wires":[]},{"id":"11e91fd3.cdc47","type":"function","name":"Add Collum in the Table","func":"msg.payload = \"alter table iotdata add column location varchar(20);\";\n\nreturn msg;","outputs":1,"x":378.02777099609375,"y":1192.7777099609375,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"bbe0fec1.abff6","type":"http in","name":"","url":"/tables_sensors","method":"get","x":146.44444274902344,"y":826.888916015625,"z":"1db0a15.c98455f","wires":[["2a229717.949558"]]},{"id":"148a472d.9d6ed9","type":"function","name":"Create Table sensors","func":"msg.payload = \"create table sensors (sensorname varchar(20), location varchar(20), date date, comment varchar(100));\";\n\nreturn msg;","outputs":1,"x":375.02777099609375,"y":734.5555419921875,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"bd1382d4.68cd7","type":"function","name":"Delete Collum from the Table","func":"msg.payload = \"alter table iotdata drop column location;\";\n\nreturn msg;","outputs":1,"x":393.6944580078125,"y":1152.4443359375,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"ba1e774e.620d88","type":"comment","name":"Add / Delete Collum Table","info":"","x":165.44444274902344,"y":1119.4443359375,"z":"1db0a15.c98455f","wires":[]},{"id":"315f47c4.032ed8","type":"function","name":"Insert into sensors","func":"msg.payload = \"insert into sensors(sensorname, location, date, comment) values('Sensor8','ストレージラック3','2017-07-14','サーバルームAに設置、TI SensorTAG使用');\";\n\nreturn msg;","outputs":1,"x":368.9166564941406,"y":1269.333251953125,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"7ca0b916.f04c78","type":"inject","name":"","topic":"","payload":"","payloadType":"none","repeat":"","crontab":"","once":false,"x":142.91665649414062,"y":1268.833251953125,"z":"1db0a15.c98455f","wires":[["315f47c4.032ed8"]]},{"id":"a23beb52.fee488","type":"comment","name":"Add / Delete Data","info":"","x":143.66665649414062,"y":1227.833251953125,"z":"1db0a15.c98455f","wires":[]},{"id":"83fa44c0.0fcc78","type":"function","name":"Select * from sensor_data","func":"msg.payload = \"select * from sensor_data;\";\n\nreturn msg;","outputs":1,"x":383.02777099609375,"y":944.7777099609375,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"b02a2865.adb6e8","type":"debug","name":"","active":true,"console":"false","complete":"false","x":1044.7777709960938,"y":835.5277099609375,"z":"1db0a15.c98455f","wires":[]},{"id":"91e9f73f.4d7398","type":"postgres","postgresdb":"b88098e5.2edd18","name":"postgres","output":true,"outputs":1,"x":828.0277709960938,"y":875.5277099609375,"z":"1db0a15.c98455f","wires":[["b02a2865.adb6e8","d4eecab1.400948"]]},{"id":"eabd674.0161398","type":"http in","name":"","url":"/select_sensors","method":"get","x":148.55555725097656,"y":944.6666259765625,"z":"1db0a15.c98455f","wires":[["83fa44c0.0fcc78"]]},{"id":"d4eecab1.400948","type":"http response","name":"","x":1035.5555419921875,"y":927.3333740234375,"z":"1db0a15.c98455f","wires":[]},{"id":"204d06ca.f26afa","type":"http in","name":"","url":"/select_iotdata","method":"get","x":145.66665649414062,"y":982.888916015625,"z":"1db0a15.c98455f","wires":[["24fc6e19.901852"]]},{"id":"ca1f2b12.0b58c8","type":"function","name":"Select * from information_schema","func":"msg.payload = \"select * from information_schema.columns where table_name = 'iotdata' ORDER BY ordinal_position;\";\n\nreturn msg;","outputs":1,"x":417,"y":865,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"d576d8d1.ce7608","type":"http in","name":"","url":"/tables_iotdata","method":"get","x":144,"y":865,"z":"1db0a15.c98455f","wires":[["ca1f2b12.0b58c8"]]},{"id":"2411a2d3.40cf4e","type":"comment","name":"Select Data","info":"","x":120,"y":909,"z":"1db0a15.c98455f","wires":[]},{"id":"2ef11bc9.766284","type":"http in","name":"","url":"/query","method":"get","x":117,"y":1731,"z":"cdc0c767.e028d8","wires":[["eb140b88.b65198"]]},{"id":"58424873.4f9d78","type":"postgres","postgresdb":"b88098e5.2edd18","name":"postgres","output":true,"outputs":1,"x":576,"y":1728,"z":"cdc0c767.e028d8","wires":[["bb78d723.e5e6d8","9d018dc.3296e7"]]},{"id":"bb78d723.e5e6d8","type":"http response","name":"","x":745,"y":1772,"z":"cdc0c767.e028d8","wires":[]},{"id":"9d018dc.3296e7","type":"debug","name":"","active":false,"console":"false","complete":"false","x":765,"y":1682,"z":"cdc0c767.e028d8","wires":[]},{"id":"17e52e99.8b48d1","type":"function","name":"Select count(*) from iotdata","func":"msg.payload = \"select count(*) from iotdata;\";\n\nreturn msg;","outputs":1,"x":387,"y":1058,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"4ddb7b88.fcd2b4","type":"function","name":"Select Count(*) from sensor_data","func":"msg.payload = \"select count(*) from sensor_data;\";\n\nreturn msg;","outputs":1,"x":406.77777099609375,"y":1020.2777099609375,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"e7fb4adf.bc6eb8","type":"http in","name":"","url":"/select_sensors_c","method":"get","x":149.30555725097656,"y":1020.1666259765625,"z":"1db0a15.c98455f","wires":[["4ddb7b88.fcd2b4"]]},{"id":"dc62da80.516418","type":"http in","name":"","url":"/select_iotdata_c","method":"get","x":146.41665649414062,"y":1058.388916015625,"z":"1db0a15.c98455f","wires":[["17e52e99.8b48d1"]]},{"id":"308f968c.5ac05a","type":"function","name":"Delete All Data From Table","func":"msg.payload = \"delete from iotdata;\";\n\nreturn msg;","outputs":1,"x":395,"y":1389,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"71fd41ce.36bcb","type":"inject","name":"","topic":"","payload":"","payloadType":"none","repeat":"","crontab":"","once":false,"x":143,"y":1388.5,"z":"1db0a15.c98455f","wires":[["308f968c.5ac05a"]]},{"id":"e12896c6.8875c8","type":"inject","name":"","topic":"","payload":"select version();","payloadType":"string","repeat":"","crontab":"","once":false,"x":167,"y":1437,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"62722829.5be738","type":"inject","name":"select count(*) from sensors;","topic":"","payload":"select count(*) from sensor_data;","payloadType":"string","repeat":"","crontab":"","once":false,"x":206,"y":1476,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"6cba3619.4df768","type":"inject","name":"select * from sensors;","topic":"","payload":"select * from sensor_data;","payloadType":"string","repeat":"","crontab":"","once":false,"x":184,"y":1515,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"c045c0d2.bbe2","type":"inject","name":"create table sensor_data","topic":"","payload":"create table sensor_data (sensorname varchar(30) primary key, location varchar(30), room varchar(30), registerdate varchar(20), comment varchar(100));","payloadType":"string","repeat":"","crontab":"","once":false,"x":192,"y":1553,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"25b16769.f63018","type":"inject","name":"insert data to sensor_data","topic":"","payload":"insert into sensor_data(sensorname, room, location, registerdate, comment) values('Sensor1','サーバルームA','サーバラック1','2017-07-20','Ti SensorTAG使用、電池新品投入');","payloadType":"string","repeat":"","crontab":"","once":false,"x":196,"y":1592,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"5e315010.bcb2b","type":"inject","name":"drop table sensor_data;","topic":"","payload":"drop table sensor_data;","payloadType":"string","repeat":"","crontab":"","once":false,"x":189.44445037841797,"y":1629.999942779541,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"ead8d66.440d828","type":"template","name":"Make SQL","field":"payload","template":"select * from iotdata where sensorname = '{{sensorname}}';","x":408,"y":1729,"z":"cdc0c767.e028d8","wires":[["58424873.4f9d78"]]},{"id":"eb140b88.b65198","type":"function","name":"Payload sensorname collumn","func":"msg.sensorname = msg.payload.sensorname;\nreturn msg;","outputs":1,"x":268,"y":1818,"z":"cdc0c767.e028d8","wires":[["ead8d66.440d828"]]},{"id":"e75e2c2a.eedf5","type":"inject","name":"create table iotdata","topic":"","payload":"create table iotdata (sensorname varchar(30), date varchar(20), time varchar(20), timestamp timestamp without time zone, temperature numeric, humidity numeric);","payloadType":"string","repeat":"","crontab":"","once":false,"x":181.44445037841797,"y":1713.5555725097656,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"ebe545dc.9c8a88","type":"inject","name":"drop table iotdata;","topic":"","payload":"drop table iotdata;","payloadType":"string","repeat":"","crontab":"","once":false,"x":176.11111450195312,"y":1674.2221698760986,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"90bc5f1c.d7788","type":"http in","name":"","url":"/api1/v1/sensor_data/all","method":"get","x":169.66665649414062,"y":98.88887786865234,"z":"a8412bb4.2f2328","wires":[["f76a07a0.e11ff8"]]},{"id":"f76a07a0.e11ff8","type":"function","name":"Select * from sensor_data","func":"msg.payload = \"select * from sensor_data order by sensorname;\";\n\nreturn msg;","outputs":1,"x":437.77783203125,"y":99.99993896484375,"z":"a8412bb4.2f2328","wires":[["47bce06e.7f7ff"]]},{"id":"ece64d04.1078f","type":"function","name":"Message Headers","func":"msg.headers = {\n \"Access-Control-Allow-Origin\":\"*\",\n \"Access-Control-Allow-Method\":\"GET,POST,PUT,DELETE,OPTIONS\",\n \"Access-Control-Allow-Headers\":\"Origin, X-Requested-With, Content-Type, Accept\"\n}\nreturn msg;","outputs":1,"x":873.3334121704102,"y":100.00000858306885,"z":"a8412bb4.2f2328","wires":[["32fda772.3300c8","a5ba617b.f17ef"]]},{"id":"47bce06e.7f7ff","type":"postgres","postgresdb":"b88098e5.2edd18","name":"postgres","output":true,"outputs":1,"x":697.7778549194336,"y":100.00000858306885,"z":"a8412bb4.2f2328","wires":[["ece64d04.1078f"]]},{"id":"32fda772.3300c8","type":"debug","name":"","active":true,"console":"false","complete":"false","x":1054.444580078125,"y":55.555524826049805,"z":"a8412bb4.2f2328","wires":[]},{"id":"a5ba617b.f17ef","type":"http response","name":"","x":1040.7779273986816,"y":136.25007247924805,"z":"a8412bb4.2f2328","wires":[]},{"id":"8e627642.c96d38","type":"http in","name":"","url":"/api1/v1/sensor_data/list","method":"get","x":170.11109924316406,"y":201,"z":"a8412bb4.2f2328","wires":[["3ce0fe84.a6ee62"]]},{"id":"3ce0fe84.a6ee62","type":"function","name":"Payload sensorname collumn","func":"msg.sensorname = msg.payload.sensorname;\nmsg.location = msg.payload.location;\nmsg.room = msg.payload.room;\nmsg.registerdate = msg.payload.registerdate;\nmsg.comment = msg.payload.comment;\nreturn msg;","outputs":1,"x":494.6666564941406,"y":201.11109924316406,"z":"a8412bb4.2f2328","wires":[["443aabca.57cd04"]]},{"id":"443aabca.57cd04","type":"template","name":"Make SQL","field":"payload","template":"select * from sensor_data where sensorname = '{{sensorname}}' or location = '{{location}}' or room = '{{room}}' or registerdate = '{{registerdate}}';","x":706.111083984375,"y":200.99996948242188,"z":"a8412bb4.2f2328","wires":[["47bce06e.7f7ff"]]},{"id":"867ef304.ac68e","type":"function","name":"Payload sensorname collumn","func":"msg.sensorname = msg.payload.sensorname;\nmsg.location = msg.payload.location;\nmsg.room = msg.payload.room;\nmsg.registerdate = msg.payload.registerdate;\nmsg.comment = msg.payload.comment;\n\nreturn msg;","outputs":1,"x":496.888916015625,"y":289.77777099609375,"z":"a8412bb4.2f2328","wires":[["3956de33.d2a402"]]},{"id":"3956de33.d2a402","type":"template","name":"Make SQL","field":"payload","template":"insert into sensor_data(sensorname, location, room, registerdate, comment) values('{{sensorname}}','{{location}}','{{room}}','{{registerdate}}','{{comment}}');","x":710.3333129882812,"y":289.6666259765625,"z":"a8412bb4.2f2328","wires":[["47bce06e.7f7ff"]]},{"id":"4f959c3d.eb6544","type":"http in","name":"","url":"/api1/v1/sensor_data/add","method":"get","x":175.6666717529297,"y":288.6666564941406,"z":"a8412bb4.2f2328","wires":[["867ef304.ac68e"]]},{"id":"70b90c88.439704","type":"debug","name":"","active":false,"console":"false","complete":"false","x":753,"y":581,"z":"cdc0c767.e028d8","wires":[]},{"id":"b88d610f.e3eb","type":"http in","name":"","url":"/api1/v1/sensor_data/del","method":"get","x":173,"y":378,"z":"a8412bb4.2f2328","wires":[["93b2849f.dd0788"]]},{"id":"93b2849f.dd0788","type":"function","name":"Payload sensorname collumn","func":"msg.sensorname = msg.payload.sensorname;\n\nreturn msg;","outputs":1,"x":499,"y":378,"z":"a8412bb4.2f2328","wires":[["285e1189.c39b5e"]]},{"id":"285e1189.c39b5e","type":"template","name":"Make SQL","field":"payload","template":"delete from sensor_data where sensorname = '{{sensorname}}';","x":714,"y":378,"z":"a8412bb4.2f2328","wires":[["47bce06e.7f7ff"]]},{"id":"dd073994.a626e8","type":"http in","name":"","url":"/api1/v1/sensor_data/update","method":"get","x":187,"y":460,"z":"a8412bb4.2f2328","wires":[["45f0df23.4d41f"]]},{"id":"45f0df23.4d41f","type":"function","name":"Payload sensorname collumn","func":"msg.sensorname = msg.payload.sensorname;\nmsg.location = msg.payload.location;\nmsg.room = msg.payload.room;\nmsg.date = msg.payload.registerdate;\nmsg.comment = msg.payload.comment;\n\nreturn msg;","outputs":1,"x":500,"y":461,"z":"a8412bb4.2f2328","wires":[["877091ce.a051f"]]},{"id":"877091ce.a051f","type":"template","name":"Make SQL","field":"payload","template":"update sensor_data set comment = '{{comment}}' where sensorname = '{{sensorname}}'; ","x":713.4443969726562,"y":460.88885498046875,"z":"a8412bb4.2f2328","wires":[["47bce06e.7f7ff"]]},{"id":"daceb4d6.a291c8","type":"comment","name":"Select * From Sensor_data","info":"","x":163,"y":61,"z":"a8412bb4.2f2328","wires":[]},{"id":"9975b69.7c3db48","type":"comment","name":"Select * From Sensor_data where XXX","info":"","x":199,"y":165,"z":"a8412bb4.2f2328","wires":[]},{"id":"3b49601b.383a7","type":"comment","name":"Insert into sensor_data","info":"","x":151,"y":253,"z":"a8412bb4.2f2328","wires":[]},{"id":"31bf060d.15f71a","type":"comment","name":"Delete from sensor_data","info":"","x":157,"y":341,"z":"a8412bb4.2f2328","wires":[]},{"id":"4fca6c93.2f4dc4","type":"comment","name":"Update sensor_data","info":"","x":144,"y":424,"z":"a8412bb4.2f2328","wires":[]},{"id":"83b4152d.d729c8","type":"http in","name":"","url":"/sensor_info","method":"get","x":140,"y":108,"z":"22b4aa07.a66d76","wires":[["f1952282.4d94"]]},{"id":"f1952282.4d94","type":"template","name":"HTML & Javascript","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<title>JavaScript Form Test</title>\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/css/tabulator.min.css\">\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script> \n\t<script type=\"text/javascript\" src=\"https://www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/fancytree/dist/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/js/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n</head>\n<body>\n<h1>センサー管理メニュー</h1>\n<br><br>\n\n<p>■ 設置センサー 一覧 ■</p>\n\n<br>\n<div id=\"example-table\" style=\"width: 60%;\"></div>\n<br>\n<form>\n<input type=\"button\"  value=\"センサー一覧更新\" onclick=\"koshin()\">\n</form>\n</br>\n\n<!--\n<p>■ センサー 検索 ■</p>\n<br>\n<form action=\"/api1/v1/sensor_data/list\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p>Location：<input type=\"text\" name=\"location\" value=\"\" size=\"20\" /></p></br>\n<p>Room Name：<input type=\"text\" name=\"room\" value=\"\" size=\"20\" /></p></br>\n<p>Register Date：<input type=\"text\" name=\"registerdate\" value=\"\" size=\"20\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"検索\" /></p>\n</form>\n<br><br>\n-->\n\n<!-- センサー検索画面を開く -->\n<br>\n<form>\n<input type=\"button\" value=\"センサー検索\" onclick=\"winOpen1()\">\n</form>\n<br>\n\n<!--\n<p>■ センサー 追加 ■</p>\n<br>\n<form action=\"/api1/v1/sensor_data/add\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p>Location：<input type=\"text\" name=\"location\" value=\"\" size=\"20\" /></p></br>\n<p>Room Name：<input type=\"text\" name=\"room\" value=\"\" size=\"20\" /></p></br>\n<p>Register Date：<input type=\"text\" name=\"date\" value=\"\" size=\"20\" /></p></br>\n<p>Comment：<input type=\"text\" name=\"comment\" value=\"\" size=\"50\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"追加\" /></p>\n</form>\n<br><br>\n-->\n\n<!-- センサー追加画面を開く -->\n<br>\n<form>\n<input type=\"button\" value=\"センサー追加\" onclick=\"winOpen2()\">\n</form>\n<br>\n\n<!--\n<p>■ センサー 情報更新 ■</p>\n<br>\n<form action=\"/api1/v1/sensor_data/update\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p>Comment：<input type=\"text\" name=\"comment\" value=\"\" size=\"50\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"更新\" /></p>\n</form>\n<br><br>\n-->\n\n<!-- センサー情報更新画面を開く -->\n<br>\n<form>\n<input type=\"button\" value=\"センサー情報更新\" onclick=\"winOpen3()\">\n</form>\n<br>\n\n<!--\n<p>■ センサー 削除 ■</p>\n<br>\n<form action=\"/api1/v1/sensor_data/del\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"削除\" /></p>\n</form>\n<br><br>\n-->\n\n<!-- センサー削除画面を開く -->\n<br>\n<form>\n<input type=\"button\" value=\"センサー削除\" onclick=\"winOpen4()\">\n</form>\n<br>\n\n<!-- ブラウザ前画面に戻る、更新ボタン -->\n<form>\n<input type=\"button\"  value=\"戻る\" onclick=\"modoru()\">\n<input type=\"button\"  value=\"更新\" onclick=\"koshin()\">\n</form>\n\n<script>\n\nfunction modoru(){\n  history.back();\n}\n\nfunction koshin(){\n  location.reload();\n}\n\nfunction winOpen1(){\nwindow.open(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/search_sensor\",\"sub\",\"width=640,height=480,top=100,left=100\");\n}\n\nfunction winOpen2(){\nwindow.open(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/add_sensor\",\"sub\",\"width=640,height=480,top=100,left=100\");\n}\n\nfunction winOpen3(){\nwindow.open(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/update_sensor\",\"sub\",\"width=640,height=480,top=100,left=100\");\n}\n\nfunction winOpen4(){\nwindow.open(\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/delete_sensor\",\"sub\",\"width=640,height=480,top=100,left=100\");\n}\n\n//koshin();\ndatetimeweek();\n\n$(\"#example-table\").tabulator({\n\tcolumns:[\n\t\t{title:\"SensorName\", field:\"sensorname\", sortable:true, width:100},\n\t\t{title:\"Room\", field:\"room\", sortable:true, sorter:\"string\", width:200},\n\t\t{title:\"Location\", field:\"location\", sortable:true, sorter:\"string\", width:200},\n\t\t{title:\"Registration Date\", field:\"registerdate\", sortable:true, width:150},\n\t\t{title:\"Comment\", field:\"comment\", sortable:false, width:500},\n\t],\n});\n\n$(\"#example-table\").tabulator(\"setData\", \"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/api1/v1/sensor_data/all\");\n\n$(window).resize(function(){\n\t$(\"#example-table\").tabulator(\"redraw\");\n});\n\n</script>\n\n</body>\n</html>","x":360,"y":108,"z":"22b4aa07.a66d76","wires":[["8296942f.30bf78"]]},{"id":"8296942f.30bf78","type":"http response","name":"","x":651,"y":109,"z":"22b4aa07.a66d76","wires":[]},{"id":"a432f5f3.b0b938","type":"comment","name":"センサー情報管理","info":"","x":142,"y":69,"z":"22b4aa07.a66d76","wires":[]},{"id":"b06aeb60.2c5f18","type":"http in","name":"","url":"/search_sensor","method":"get","x":152,"y":228,"z":"22b4aa07.a66d76","wires":[["8e77afa1.a8992"]]},{"id":"8e77afa1.a8992","type":"template","name":"HTML + Javascript","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<title>Sensor Search</title>\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/css/tabulator.min.css\">\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script> \n\t<script type=\"text/javascript\" src=\"https://www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/fancytree/dist/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/js/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n</head>\n<body>\n\n<h1>センサー検索</h1>\n<br><br>\n<form action=\"/api1/v1/sensor_data/list\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p>Location：<input type=\"text\" name=\"location\" value=\"\" size=\"20\" /></p></br>\n<p>Room Name：<input type=\"text\" name=\"room\" value=\"\" size=\"20\" /></p></br>\n<p>Register Date：<input type=\"text\" name=\"registerdate\" value=\"\" size=\"20\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"検索\" /></p>\n</form>\n<br>\n\n<!--\n<br>\n<div id=\"search-table\" style=\"width: 100%;\"></div>\n<br>\n-->\n\n<p><input type=\"submit\" onClick=\"window.close();\" value=\"閉じる\" /></p>\n\n<script>\n\n$(\"#search-table\").tabulator({\n\tcolumns:[\n\t\t{title:\"SensorName\", field:\"sensorname\", sortable:true, width:100},\n\t\t{title:\"Room\", field:\"room\", sortable:true, sorter:\"string\", width:200},\n\t\t{title:\"Location\", field:\"location\", sortable:true, sorter:\"string\", width:200},\n\t\t{title:\"Registration Date\", field:\"registerdate\", sortable:true, width:150},\n\t\t{title:\"Comment\", field:\"comment\", sortable:false, width:500},\n\t],\n});\n\n$(\"#search-table\").tabulator(\"setData\", \"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/api1/v1/sensor_data/list?\");\n\n$(window).resize(function(){\n\t$(\"#search-table\").tabulator(\"redraw\");\n});\n\n</script>\n\n\n</body>\n</html>","x":362,"y":228,"z":"22b4aa07.a66d76","wires":[["8296942f.30bf78"]]},{"id":"f7fa6281.9d9bb","type":"template","name":"HTML + Javascript","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<title>JavaScript Form Test</title>\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/css/tabulator.min.css\">\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script> \n\t<script type=\"text/javascript\" src=\"https://www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/fancytree/dist/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/js/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n</head>\n<body>\n\n<h1>■ センサー追加 ■</h1>\n<br>\n<form action=\"/api1/v1/sensor_data/add\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p>Location：<input type=\"text\" name=\"location\" value=\"\" size=\"20\" /></p></br>\n<p>Room Name：<input type=\"text\" name=\"room\" value=\"\" size=\"20\" /></p></br>\n<p>Register Date：<input type=\"text\" name=\"registerdate\" value=\"\" size=\"20\" /></p></br>\n<p>Comment：<input type=\"text\" name=\"comment\" value=\"\" size=\"50\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"追加\" /></p>\n</form>\n\n<br>\n<p><input type=\"submit\" onClick=\"window.close();\" value=\"閉じる\" /></p>\n\n</body>\n</html>","x":364,"y":306,"z":"22b4aa07.a66d76","wires":[["8296942f.30bf78"]]},{"id":"36215c9c.2fedf4","type":"http in","name":"","url":"/add_sensor","method":"get","x":145,"y":305,"z":"22b4aa07.a66d76","wires":[["f7fa6281.9d9bb"]]},{"id":"110d8197.d0130e","type":"http in","name":"","url":"/update_sensor","method":"get","x":156,"y":380,"z":"22b4aa07.a66d76","wires":[["d6a24c00.589bb"]]},{"id":"d6a24c00.589bb","type":"template","name":"HTML + Javascript","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<title>JavaScript Form Test</title>\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/css/tabulator.min.css\">\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script> \n\t<script type=\"text/javascript\" src=\"https://www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/fancytree/dist/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/js/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n</head>\n<body>\n\n<h1>■ センサー 情報更新 ■</h1>\n<br>\n<form action=\"/api1/v1/sensor_data/update\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p>Comment：<input type=\"text\" name=\"comment\" value=\"\" size=\"50\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"更新\" /></p>\n</form>\n\n<br>\n<p><input type=\"submit\" onClick=\"window.close();\" value=\"閉じる\" /></p>\n\n</body>\n</html>","x":363,"y":375,"z":"22b4aa07.a66d76","wires":[["8296942f.30bf78"]]},{"id":"81a4a787.31e4c8","type":"http in","name":"","url":"/delete_sensor","method":"get","x":153,"y":452,"z":"22b4aa07.a66d76","wires":[["a677bfe9.9015b"]]},{"id":"a677bfe9.9015b","type":"template","name":"HTML + Javascript","field":"payload","template":"<!DOCTYPE html>\n<html lang = \"ja\">\n<head>\n\t<meta charset = \"utf-8\">\n\t<title>JavaScript Form Test</title>\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/css/style2.css\">\n\t<link rel=\"stylesheet\" type=\"text/css\" href=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/css/tabulator.min.css\">\n\t<script type=\"text/javascript\" src=\"https://www.gstatic.com/charts/loader.js\"></script> \n\t<script type=\"text/javascript\" src=\"https://www.google.com/jsapi\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-3.2.1.min.js\" integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\" crossorigin=\"anonymous\"></script>\n\t<script type=\"text/javascript\" src=\"https://code.jquery.com/ui/1.12.1/jquery-ui.min.js\" integrity=\"sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=\" crossorigin=\"anonymous\"></script> \n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/fancytree/dist/jquery.fancytree-all.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/dist/js/tabulator.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/kousin.js\"></script>\n\t<script type=\"text/javascript\" src=\"https://h2lnoavy-ncwpzaor.jp-east-1.cf-app.net/script/date-time-week.js\"></script>\n</head>\n<body>\n\n<h1>■ センサー 削除 ■</h1>\n<br>\n<form action=\"/api1/v1/sensor_data/del\" method=\"GET\">\n<p>Sensor Name：<input type=\"text\" name=\"sensorname\" value=\"\" size=\"20\" /></p></br>\n<p><input type=\"submit\" name=\"submit\" value=\"削除\" /></p>\n</form>\n\n<br>\n<p><input type=\"submit\" onClick=\"window.close();\" value=\"閉じる\" /></p>\n\n</body>\n</html>","x":368,"y":449,"z":"22b4aa07.a66d76","wires":[["8296942f.30bf78"]]},{"id":"d0819558.ef43c8","type":"mqtt in","name":"Sensor-SD001","topic":"testcode2/v1/ITP314-001/DTC/SD001","broker":"11917135.5de19f","x":107,"y":486,"z":"cdc0c767.e028d8","wires":[["57228b5e.305f74"]]},{"id":"32f92419.f4567c","type":"mqtt in","name":"Sensor-SD002","topic":"testcode2/v1/ITP314-001/DTC/SD002","broker":"11917135.5de19f","x":106,"y":533,"z":"cdc0c767.e028d8","wires":[["57228b5e.305f74"]]},{"id":"71b1e89d.05e668","type":"mqtt in","name":"Sensor-SD003","topic":"testcode2/v1/ITP314-001/DTC/SD003","broker":"11917135.5de19f","x":107,"y":582,"z":"cdc0c767.e028d8","wires":[["57228b5e.305f74"]]},{"id":"34f7dfec.bf4a8","type":"mqtt in","name":"Sensor-SD004","topic":"testcode2/v1/ITP314-001/DTC/SD004","broker":"11917135.5de19f","x":106,"y":628,"z":"cdc0c767.e028d8","wires":[["57228b5e.305f74"]]},{"id":"8285b173.629b9","type":"mqtt out","name":"Sensor-SD001","topic":"testcode2/v1/ITP314-001/DTC/SD001","qos":"1","retain":"true","broker":"11917135.5de19f","x":786,"y":144,"z":"cdc0c767.e028d8","wires":[]},{"id":"bbe90f18.f4bf4","type":"mqtt out","name":"Sensor-SD002","topic":"testcode2/v1/ITP314-001/DTC/SD002","qos":"1","retain":"true","broker":"11917135.5de19f","x":787,"y":191,"z":"cdc0c767.e028d8","wires":[]},{"id":"6fa7bead.284fb","type":"mqtt out","name":"Sensor-SD003","topic":"testcode2/v1/ITP314-001/DTC/SD003","qos":"1","retain":"true","broker":"11917135.5de19f","x":789,"y":239,"z":"cdc0c767.e028d8","wires":[]},{"id":"a07d9875.508138","type":"mqtt out","name":"Sensor-SD004","topic":"testcode2/v1/ITP314-001/DTC/SD004","qos":"1","retain":"true","broker":"11917135.5de19f","x":790,"y":287,"z":"cdc0c767.e028d8","wires":[]},{"id":"f00ab304.6e1b9","type":"inject","name":"select current_timestamp","topic":"","payload":"select current_timestamp","payloadType":"string","repeat":"","crontab":"","once":false,"x":762,"y":1173,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"2af64baf.3fdbf4","type":"inject","name":"select now();","topic":"","payload":"select now();","payloadType":"string","repeat":"","crontab":"","once":false,"x":723,"y":1232,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"e9d1d561.6da238","type":"inject","name":"show timezone;","topic":"","payload":"show timezone;","payloadType":"string","repeat":"","crontab":"","once":false,"x":726,"y":1292,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"301edae5.cbcbb6","type":"inject","name":"select sensorname,max(timestamp) from iotdata group by sensorname; ","topic":"","payload":"select sensorname,max(timestamp) from iotdata group by sensorname; ","payloadType":"string","repeat":"","crontab":"","once":false,"x":848,"y":1344,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"48d2dbff.e756e4","type":"inject","name":"select max(timestamp) inner join","topic":"","payload":"select iotdataA.sensorname,iotdataA.timestamp,iotdataA.temperature,iotdataA.humidity from iotdata as iotdataA inner join (select sensorname,max(timestamp) as maxtime from iotdata group by sensorname) as iotdataB on iotdataA.sensorname = iotdataB.sensorname and iotdataA.timestamp = iotdataB.maxtime;","payloadType":"string","repeat":"","crontab":"","once":false,"x":729,"y":1380,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"2521f7d0.2a3798","type":"template","name":"Make SQL","field":"payload","template":"select iotdataA.sensorname,iotdataA.timestamp,iotdataA.date,iotdataA.time,iotdataA.temperature,iotdataA.humidity from iotdata as iotdataA inner join (select sensorname,max(timestamp) as maxtime from iotdata group by sensorname) as iotdataB on iotdataA.sensorname = iotdataB.sensorname and iotdataA.timestamp = iotdataB.maxtime;","x":444,"y":539,"z":"a8412bb4.2f2328","wires":[["47bce06e.7f7ff"]]},{"id":"84e0d837.9e6678","type":"http in","name":"","url":"/api/v1/sensor_lasttime","method":"get","x":172,"y":539,"z":"a8412bb4.2f2328","wires":[["2521f7d0.2a3798"]]},{"id":"caa7af39.270e4","type":"inject","name":"select Join database","topic":"","payload":"select iotdataA.sensorname,iotdataA.timestamp,iotdataA.date,iotdataA.time,iotdataA.temperature,iotdataA.humidity from iotdata as iotdataA inner join (select sensorname,max(timestamp) as maxtime from iotdata group by sensorname) as iotdataB on iotdataA.sensorname = iotdataB.sensorname and iotdataA.timestamp = iotdataB.maxtime;","payloadType":"string","repeat":"","crontab":"","once":false,"x":693,"y":1416,"z":"1db0a15.c98455f","wires":[["91e9f73f.4d7398"]]},{"id":"d33eaada.f03248","type":"comment","name":"Last data from iotdata Table order by Sensorname","info":"","x":241,"y":503,"z":"a8412bb4.2f2328","wires":[]},{"id":"fb9d29e4.9f2418","type":"debug","name":"","active":false,"console":"false","complete":"false","x":895,"y":362,"z":"cdc0c767.e028d8","wires":[]}]
